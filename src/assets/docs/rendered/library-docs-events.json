{
  "pageId": "library-docs/events",
  "title": "OSI Cards Library - Event System Guide",
  "html": "<h1 id=\"osi-cards-library-event-system-guide\"><a href=\"#osi-cards-library-event-system-guide\" class=\"anchor-link\" aria-hidden=\"true\">#</a>OSI Cards Library - Event System Guide</h1></p><p>This guide explains the extensible event system for handling card interactions with middleware support.</p><p><h2 id=\"overview\"><a href=\"#overview\" class=\"anchor-link\" aria-hidden=\"true\">#</a>Overview</h2></p><p>The OSI Cards library provides a powerful event system that allows you to:\n<ul><li>Intercept and transform events before they reach handlers</li><li>Add logging and debugging</li><li>Integrate analytics tracking</li><li>Filter events based on custom criteria</li><li>Chain multiple event processors</li></ul>\n<h2 id=\"basic-event-handling\"><a href=\"#basic-event-handling\" class=\"anchor-link\" aria-hidden=\"true\">#</a>Basic Event Handling</h2></p><p>Card components emit events for user interactions:</p><p><div class=\"code-block-wrapper\"><div class=\"code-header\"><span class=\"code-lang\">typescript</span><div class=\"code-actions\"><button class=\"copy-btn\" type=\"button\"><svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><rect x=\"9\" y=\"9\" width=\"13\" height=\"13\" rx=\"2\" ry=\"2\"></rect><path d=\"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\"></path></svg>Copy</button></div></div><pre><code class=\"language-typescript\">import { Component } from '@angular/core';<br>import { SectionRenderEvent } from 'osi-cards-lib';</p><p>@Component({<br>  selector: 'app-my-component',<br>  template: <code>\n    &amp;lt;app-ai-card-renderer<br>      [cardConfig]=\"card\"<br>      (sectionEvent)=\"onSectionEvent($event)\"&amp;gt;<br>    &amp;lt;/app-ai-card-renderer&amp;gt;<br>  </code>\n})<br>export class MyComponent {<br>  onSectionEvent(event: SectionRenderEvent): void {<br>    console.log('Section event:', event.type, event.section.title);<br>    <br>    if (event.type === 'field') {<br>      console.log('Field clicked:', event.field?.label);<br>    }<br>  }<br>}</code></pre></div></p><p><h2 id=\"event-middleware\"><a href=\"#event-middleware\" class=\"anchor-link\" aria-hidden=\"true\">#</a>Event Middleware</h2></p><p>Event middleware allows you to process events before they reach your handlers.</p><p><h3 id=\"creating-middleware\"><a href=\"#creating-middleware\" class=\"anchor-link\" aria-hidden=\"true\">#</a>Creating Middleware</h3></p><p><div class=\"code-block-wrapper\"><div class=\"code-header\"><span class=\"code-lang\">typescript</span><div class=\"code-actions\"><button class=\"copy-btn\" type=\"button\"><svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><rect x=\"9\" y=\"9\" width=\"13\" height=\"13\" rx=\"2\" ry=\"2\"></rect><path d=\"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\"></path></svg>Copy</button></div></div><pre><code class=\"language-typescript\">import { EventMiddleware, SectionRenderEvent } from 'osi-cards-lib';<br>import { EventMiddlewareService } from 'osi-cards-lib';</p><p>const eventService = inject(EventMiddlewareService);</p><p>// Create custom middleware<br>const myMiddleware: EventMiddleware = {<br>  priority: 50,<br>  handle: (event: SectionRenderEvent, next) =&amp;gt; {<br>    // Transform or log the event<br>    console.log('Processing event:', event);<br>    <br>    // Pass to next middleware<br>    return next(event);<br>  }<br>};</p><p>// Add middleware<br>eventService.addMiddleware(myMiddleware);</code></pre></div></p><p><h3 id=\"built-in-middleware-factories\"><a href=\"#built-in-middleware-factories\" class=\"anchor-link\" aria-hidden=\"true\">#</a>Built-in Middleware Factories</h3></p><p><h4 id=\"logging-middleware\"><a href=\"#logging-middleware\" class=\"anchor-link\" aria-hidden=\"true\">#</a>Logging Middleware</h4></p><p><div class=\"code-block-wrapper\"><div class=\"code-header\"><span class=\"code-lang\">typescript</span><div class=\"code-actions\"><button class=\"copy-btn\" type=\"button\"><svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><rect x=\"9\" y=\"9\" width=\"13\" height=\"13\" rx=\"2\" ry=\"2\"></rect><path d=\"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\"></path></svg>Copy</button></div></div><pre><code class=\"language-typescript\">const loggingMiddleware = eventService.createLoggingMiddleware();<br>eventService.addMiddleware(loggingMiddleware);</p><p>// Custom logger<br>const customLogger = eventService.createLoggingMiddleware((msg, event) =&amp;gt; {<br>  console.log(<code>[${new Date().toISOString()}] ${msg}</code>, event);<br>});<br>eventService.addMiddleware(customLogger);</code></pre></div></p><p><h4 id=\"filter-middleware\"><a href=\"#filter-middleware\" class=\"anchor-link\" aria-hidden=\"true\">#</a>Filter Middleware</h4></p><p><div class=\"code-block-wrapper\"><div class=\"code-header\"><span class=\"code-lang\">typescript</span><div class=\"code-actions\"><button class=\"copy-btn\" type=\"button\"><svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><rect x=\"9\" y=\"9\" width=\"13\" height=\"13\" rx=\"2\" ry=\"2\"></rect><path d=\"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\"></path></svg>Copy</button></div></div><pre><code class=\"language-typescript\">// Only process field events<br>const filterMiddleware = eventService.createFilterMiddleware(<br>  (event) =&amp;gt; event.type === 'field'<br>);<br>eventService.addMiddleware(filterMiddleware);</code></pre></div></p><p><h4 id=\"transform-middleware\"><a href=\"#transform-middleware\" class=\"anchor-link\" aria-hidden=\"true\">#</a>Transform Middleware</h4></p><p><div class=\"code-block-wrapper\"><div class=\"code-header\"><span class=\"code-lang\">typescript</span><div class=\"code-actions\"><button class=\"copy-btn\" type=\"button\"><svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><rect x=\"9\" y=\"9\" width=\"13\" height=\"13\" rx=\"2\" ry=\"2\"></rect><path d=\"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\"></path></svg>Copy</button></div></div><pre><code class=\"language-typescript\">// Add timestamp to all events<br>const transformMiddleware = eventService.createTransformMiddleware(<br>  (event) =&amp;gt; ({<br>    ...event,<br>    metadata: {<br>      ...event.metadata,<br>      timestamp: Date.now()<br>    }<br>  })<br>);<br>eventService.addMiddleware(transformMiddleware);</code></pre></div></p><p><h4 id=\"analytics-middleware\"><a href=\"#analytics-middleware\" class=\"anchor-link\" aria-hidden=\"true\">#</a>Analytics Middleware</h4></p><p><div class=\"code-block-wrapper\"><div class=\"code-header\"><span class=\"code-lang\">typescript</span><div class=\"code-actions\"><button class=\"copy-btn\" type=\"button\"><svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><rect x=\"9\" y=\"9\" width=\"13\" height=\"13\" rx=\"2\" ry=\"2\"></rect><path d=\"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\"></path></svg>Copy</button></div></div><pre><code class=\"language-typescript\">// Track events with analytics service<br>const analyticsMiddleware = eventService.createAnalyticsMiddleware(<br>  (eventName, properties) =&amp;gt; {<br>    // Your analytics tracking code<br>    analytics.track(eventName, properties);<br>  }<br>);<br>eventService.addMiddleware(analyticsMiddleware);</code></pre></div></p><p><h2 id=\"event-subscription\"><a href=\"#event-subscription\" class=\"anchor-link\" aria-hidden=\"true\">#</a>Event Subscription</h2></p><p>Subscribe to processed events:</p><p><div class=\"code-block-wrapper\"><div class=\"code-header\"><span class=\"code-lang\">typescript</span><div class=\"code-actions\"><button class=\"copy-btn\" type=\"button\"><svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><rect x=\"9\" y=\"9\" width=\"13\" height=\"13\" rx=\"2\" ry=\"2\"></rect><path d=\"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\"></path></svg>Copy</button></div></div><pre><code class=\"language-typescript\">import { EventMiddlewareService } from 'osi-cards-lib';</p><p>const eventService = inject(EventMiddlewareService);</p><p>// Subscribe to processed events<br>eventService.processedEvents$.subscribe(event =&amp;gt; {<br>  console.log('Processed event:', event);<br>});</p><p>// Subscribe to raw events (before middleware)<br>eventService.rawEvents$.subscribe(event =&amp;gt; {<br>  console.log('Raw event:', event);<br>});</code></pre></div></p><p><h2 id=\"event-processing-flow\"><a href=\"#event-processing-flow\" class=\"anchor-link\" aria-hidden=\"true\">#</a>Event Processing Flow</h2></p><p><ol><li><strong>Raw Event</strong> - Event is emitted from component</li><li><strong>Middleware Chain</strong> - Event passes through registered middleware (in priority order)</li><li><strong>Processed Event</strong> - Final event is emitted to subscribers</li></ol>\n<div class=\"code-block-wrapper\"><div class=\"code-header\"><span class=\"code-lang\">text</span><div class=\"code-actions\"><button class=\"copy-btn\" type=\"button\"><svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><rect x=\"9\" y=\"9\" width=\"13\" height=\"13\" rx=\"2\" ry=\"2\"></rect><path d=\"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\"></path></svg>Copy</button></div></div><pre><code class=\"language-text\">Component → Raw Event → Middleware 1 → Middleware 2 → ... → Processed Event</code></pre></div></p><p><h2 id=\"middleware-priority\"><a href=\"#middleware-priority\" class=\"anchor-link\" aria-hidden=\"true\">#</a>Middleware Priority</h2></p><p>Middleware with higher priority runs first:</p><p><div class=\"code-block-wrapper\"><div class=\"code-header\"><span class=\"code-lang\">typescript</span><div class=\"code-actions\"><button class=\"copy-btn\" type=\"button\"><svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><rect x=\"9\" y=\"9\" width=\"13\" height=\"13\" rx=\"2\" ry=\"2\"></rect><path d=\"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\"></path></svg>Copy</button></div></div><pre><code class=\"language-typescript\">const highPriorityMiddleware: EventMiddleware = {<br>  priority: 100, // Runs first<br>  handle: (event, next) =&amp;gt; next(event)<br>};</p><p>const lowPriorityMiddleware: EventMiddleware = {<br>  priority: 10, // Runs later<br>  handle: (event, next) =&amp;gt; next(event)<br>};</code></pre></div></p><p><h2 id=\"complete-example\"><a href=\"#complete-example\" class=\"anchor-link\" aria-hidden=\"true\">#</a>Complete Example</h2></p><p><div class=\"code-block-wrapper\"><div class=\"code-header\"><span class=\"code-lang\">typescript</span><div class=\"code-actions\"><button class=\"copy-btn\" type=\"button\"><svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><rect x=\"9\" y=\"9\" width=\"13\" height=\"13\" rx=\"2\" ry=\"2\"></rect><path d=\"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\"></path></svg>Copy</button></div></div><pre><code class=\"language-typescript\">import { Component, OnInit, inject } from '@angular/core';<br>import { <br>  EventMiddlewareService, <br>  SectionRenderEvent <br>} from 'osi-cards-lib';</p><p>@Component({<br>  selector: 'app-card-container',<br>  template: <code>\n    &amp;lt;app-ai-card-renderer<br>      [cardConfig]=\"card\"<br>      (sectionEvent)=\"handleEvent($event)\"&amp;gt;<br>    &amp;lt;/app-ai-card-renderer&amp;gt;<br>  </code>\n})<br>export class CardContainerComponent implements OnInit {<br>  private eventService = inject(EventMiddlewareService);<br>  <br>  ngOnInit(): void {<br>    // Add logging<br>    const logger = this.eventService.createLoggingMiddleware();<br>    this.eventService.addMiddleware(logger);<br>    <br>    // Add analytics<br>    const analytics = this.eventService.createAnalyticsMiddleware(<br>      (name, props) =&amp;gt; this.trackEvent(name, props)<br>    );<br>    this.eventService.addMiddleware(analytics);<br>    <br>    // Subscribe to processed events<br>    this.eventService.processedEvents$.subscribe(event =&amp;gt; {<br>      this.handleProcessedEvent(event);<br>    });<br>  }<br>  <br>  handleEvent(event: SectionRenderEvent): void {<br>    // Events are already processed by middleware<br>    this.eventService.processEvent(event);<br>  }<br>  <br>  handleProcessedEvent(event: SectionRenderEvent): void {<br>    // Handle the processed event<br>    console.log('Final event:', event);<br>  }<br>  <br>  trackEvent(name: string, properties: Record&amp;lt;string, unknown&amp;gt;): void {<br>    // Your analytics implementation<br>    console.log('Track:', name, properties);<br>  }<br>}</code></pre></div></p><p><h2 id=\"best-practices\"><a href=\"#best-practices\" class=\"anchor-link\" aria-hidden=\"true\">#</a>Best Practices</h2></p><p><ol><li><strong>Use Priority Wisely</strong>: Set appropriate priorities for middleware order</li><li><strong>Keep Transformations Pure</strong>: Avoid side effects in transformation middleware</li><li><strong>Handle Errors</strong>: Wrap middleware in try-catch to prevent breaking the chain</li><li><strong>Remove Middleware</strong>: Clean up middleware when components are destroyed</li><li><strong>Performance</strong>: Consider filtering early to reduce processing overhead</li></ol>\n<h2 id=\"related-documentation\"><a href=\"#related-documentation\" class=\"anchor-link\" aria-hidden=\"true\">#</a>Related Documentation</h2></p><p><ul><li><a href=\"../README.md\">README.md</a> - Library overview</li><li><a href=\"./SERVICES.md\">SERVICES.md</a> - Service documentation</li><li><a href=\"./CUSTOMIZATION.md\">CUSTOMIZATION.md</a> - Customization guide</li></ul></p><p>",
  "toc": [
    {
      "id": "osi-cards-library-event-system-guide",
      "text": "OSI Cards Library - Event System Guide",
      "level": 1
    },
    {
      "id": "overview",
      "text": "Overview",
      "level": 2
    },
    {
      "id": "basic-event-handling",
      "text": "Basic Event Handling",
      "level": 2
    },
    {
      "id": "event-middleware",
      "text": "Event Middleware",
      "level": 2
    },
    {
      "id": "creating-middleware",
      "text": "Creating Middleware",
      "level": 3
    },
    {
      "id": "built-in-middleware-factories",
      "text": "Built-in Middleware Factories",
      "level": 3
    },
    {
      "id": "logging-middleware",
      "text": "Logging Middleware",
      "level": 4
    },
    {
      "id": "filter-middleware",
      "text": "Filter Middleware",
      "level": 4
    },
    {
      "id": "transform-middleware",
      "text": "Transform Middleware",
      "level": 4
    },
    {
      "id": "analytics-middleware",
      "text": "Analytics Middleware",
      "level": 4
    },
    {
      "id": "event-subscription",
      "text": "Event Subscription",
      "level": 2
    },
    {
      "id": "event-processing-flow",
      "text": "Event Processing Flow",
      "level": 2
    },
    {
      "id": "middleware-priority",
      "text": "Middleware Priority",
      "level": 2
    },
    {
      "id": "complete-example",
      "text": "Complete Example",
      "level": 2
    },
    {
      "id": "best-practices",
      "text": "Best Practices",
      "level": 2
    },
    {
      "id": "related-documentation",
      "text": "Related Documentation",
      "level": 2
    }
  ],
  "contentHash": "6b77c7e62c00baf2",
  "generatedAt": "2025-12-01T09:15:43.747Z",
  "demoConfigs": {}
}