/* ===================================================================
   GLOBAL ENFORCEMENT - NO OVERRIDES ALLOWED
   =================================================================== */
/* This file enforces global settings across ALL sections */
/* Sections MUST NOT override these settings */
/* IMPORTANT: This file MUST be imported LAST to override all sections */

@use '../../core/surface-layers' as *;
/* 
 * UNIFIED CARD SYSTEM:
 * ====================
 * 
 * ALL CARDS USE IDENTICAL STYLING - NO VARIATIONS ALLOWED
 * - Padding: var(--card-padding) - Same for all cards
 * - Border: var(--card-border) - Same for all cards
 * - Border-radius: var(--section-card-border-radius) - Same for all cards
 * - Gap: var(--card-gap) - Same for all cards
 * - Background: var(--card-background) - Same for all cards
 * - Box-shadow: var(--card-box-shadow) - Same for all cards
 * - Hover states: var(--card-hover-*) - Same for all cards
 * - Colors: var(--card-text-*) - Same for all cards
 * 
 * BORDER STRATEGY:
 * 1. Only sections (.masonry-item) have borders
 * 2. Only direct child cards (.contact-card, .overview-card, etc.) have borders
 * 3. All nested elements (with __ in class name) have NO borders
 * 4. All grid/container elements have NO borders
 * 
 * NO CALC() EXPRESSIONS:
 * - All spacing uses direct variables (no calc() multipliers)
 * - No percentage-based calculations (no *0.75, *0.5, etc.)
 * - All values come from _variables.scss
 * 
 * FLATTENED HIERARCHY:
 * ====================
 * 
 * Optimized DOM structure - removed unnecessary nesting:
 * - .masonry-item (section container - has border, padding, background, gap)
 *   - .ai-section (transparent wrapper - no visual styling)
 *     - .ai-section__header (header content)
 *     - .ai-section__body (grid/flex container - cards are direct children)
 *       - Cards (direct children - no wrapper divs in between)
 * 
 * Grid/collection wrappers (.section-grid, .contact-collection, etc.) use display: contents
 * to flatten the hierarchy. Cards become direct children of .ai-section__body.
 * 
 * This ensures 100% consistency across all card types.
 */

/* ===== SECTION CONTAINER ENFORCEMENT ===== */
/* All sections use these exact settings - NO EXCEPTIONS */

/* IMPORTANT: Flatten .ai-section when inside .masonry-item */
/* The .masonry-item (section container) already has the border, padding, background */
/* .ai-section becomes a minimal flex container with no visual styling */
.masonry-item .ai-section {
  /* NO VISUAL STYLING: Parent .masonry-item has all visual properties */
  border: none !important;
  border-radius: 0 !important;
  padding: 0 !important;
  margin: 0 !important;
  background: transparent !important;
  box-shadow: none !important;
  
  /* Minimal flex container - no gap (gap is on masonry-item) */
  display: flex !important;
  flex-direction: column !important;
  gap: 0 !important;
  width: 100% !important;
  height: auto !important;
}

/* Flatten .ai-section__header when inside masonry-item */
.masonry-item .ai-section__header {
  /* Remove any padding/margin - masonry-item handles spacing */
  padding: 0 0 var(--section-header-padding-bottom) 0 !important;
  margin: 0 !important;
  gap: var(--section-header-gap) !important;
}

/* Flatten .ai-section__body when inside masonry-item */
/* Apply grid layout by default - cards become direct children when wrappers use display: contents */
.masonry-item .ai-section__body {
  padding: 0 !important;
  margin: 0 !important;
  flex: 1 !important;
  /* Default: grid layout for card-based sections */
  display: grid !important;
  grid-template-columns: repeat(auto-fit, minmax(var(--section-grid-min-width), 1fr)) !important;
  gap: var(--section-card-gap) !important;
  min-height: 0 !important;
  
  @media (max-width: 520px) {
    grid-template-columns: 1fr !important;
  }
}

/* Make all grid/collection wrappers transparent - flatten hierarchy */
/* Use display: contents so wrappers disappear and cards become direct children of body */
/* This includes wrappers with Tailwind classes applied via ngClass */
.masonry-item .section-grid,
.masonry-item .section-grid--metrics,
.masonry-item .section-grid--reference,
.masonry-item .section-grid--quotation,
.masonry-item .info-matrix,
.masonry-item .contact-grid,
.masonry-item .contact-collection,
.masonry-item .network-grid,
.masonry-item .map-grid,
.masonry-item .chart-section__list,
.masonry-item .chart-section__split,
.masonry-item .product-grid,
.masonry-item .product-layout,
.masonry-item .product-reference-list,
.masonry-item .overview-grid,
.masonry-item .analytics-metrics,
.masonry-item .financials-grid,
/* Also target any div with grid classes inside masonry-item body */
.masonry-item .ai-section__body > div[class*="grid"],
.masonry-item .ai-section__body > div.grid {
  padding: 0 !important;
  margin: 0 !important;
  border: none !important;
  background: transparent !important;
  box-shadow: none !important;
  gap: var(--section-card-gap) !important;
}

/* For list sections, make wrapper transparent */
.masonry-item .section-list,
.masonry-item .solutions-list {
  /* Make wrapper transparent - flatten hierarchy */
  display: contents !important;
  padding: 0 !important;
  margin: 0 !important;
  border: none !important;
  background: transparent !important;
  box-shadow: none !important;
  gap: 0 !important;
}

/* Override grid with flex for list sections */
.masonry-item .ai-section--list .ai-section__body {
  display: flex !important;
  flex-direction: column !important;
  grid-template-columns: none !important;
  gap: var(--section-card-gap) !important;
}

/* Event sections have custom timeline layout - preserve their structure */
/* The wrapper with "relative space-y-4" classes should remain but be optimized */
.masonry-item .ai-section--event .ai-section__body {
  /* Event sections use custom timeline - don't force grid on body */
  display: block !important;
  grid-template-columns: none !important;
}

/* Optimize event timeline wrapper - keep layout but remove visual styling */
.masonry-item .ai-section--event .ai-section__body > .relative {
  /* Keep relative positioning for timeline line */
  position: relative !important;
  /* Use our unified gap instead of Tailwind space-y-4 */
  display: flex !important;
  flex-direction: column !important;
  gap: var(--section-card-gap) !important;
  padding: 0 !important;
  margin: 0 !important;
}

/* Event timeline line styling - keep minimal */
.masonry-item .ai-section--event .ai-section__body .relative > .absolute {
  /* Timeline line - keep positioning but use our colors */
  position: absolute !important;
  left: 12px !important;
  top: 12px !important;
  bottom: 12px !important;
  width: 1px !important;
  background: var(--card-border) !important;
  opacity: 0.3 !important;
}

/* Standalone .ai-section (not in masonry) - has border */
.ai-section:not(.masonry-item .ai-section),
.section-block {
  /* Padding - GLOBALLY ENFORCED */
  padding: var(--section-padding) !important;
  
  /* Border - GLOBALLY ENFORCED (only if not inside masonry-item) */
  border: var(--card-border) !important;
  border-radius: var(--card-border-radius) !important;
  
  /* Gap between cards - GLOBALLY ENFORCED */
  gap: var(--section-card-gap) !important;
}

/* ===== SECTION TITLE ENFORCEMENT ===== */
/* All section titles use these exact settings - NO EXCEPTIONS */

.ai-section__title,
.section-block__title {
  /* Font - GLOBALLY ENFORCED */
  font-size: var(--section-title-font-size) !important;
  font-weight: var(--section-title-font-weight) !important;
  letter-spacing: var(--section-title-letter-spacing) !important;
  line-height: var(--section-title-line-height) !important;
  color: var(--card-text-primary) !important;
  
  /* Remove any custom padding/margin */
  padding: 0 !important;
  margin: 0 0 8px 0 !important;
}

/* ===== SECTION HEADER ENFORCEMENT ===== */
/* All section headers use these exact settings - NO EXCEPTIONS */

.ai-section__header {
  /* UNIFIED: Use direct variables (no calc) */
  padding: 0 0 var(--section-header-padding-bottom) 0 !important;
  gap: var(--section-header-gap) !important;
}

/* ===== UNIFIED NESTED ELEMENT SPACING ===== */
/* All nested elements inside cards use identical spacing */
/* This ensures consistency across all card types */

/* Remove borders from nested elements */
[class*="__"],
.ai-card-title {
  /* NO BORDERS */
  border: none !important;
  border-width: 0 !important;
  border-style: none !important;
  border-color: transparent !important;
  border-top: none !important;
  border-right: none !important;
  border-bottom: none !important;
  border-left: none !important;
  border-block: none !important;
  border-inline: none !important;
  border-image: none !important;
  border-radius: 0 !important;
  
  /* NO OUTLINES */
  outline: none !important;
  outline-width: 0 !important;
  outline-style: none !important;
  outline-color: transparent !important;
  outline-offset: 0 !important;
  
  /* NO PADDING */
  padding: 0 !important;
  padding-top: 0 !important;
  padding-right: 0 !important;
  padding-bottom: 0 !important;
  padding-left: 0 !important;
  padding-block: 0 !important;
  padding-inline: 0 !important;
  
  /* NO SHADOWS OR DECORATIONS */
  box-shadow: none !important;
  text-decoration: none !important;
  text-decoration-line: none !important;
  text-decoration-style: none !important;
  text-decoration-color: transparent !important;
  text-underline-offset: 0 !important;
  text-decoration-thickness: 0 !important;
  
  /* Don't override background - nested elements may need backgrounds for styling */
  
  /* NO PSEUDO-ELEMENT BORDERS OR PADDING */
  &::before,
  &::after {
    display: none !important;
    border: none !important;
    border-width: 0 !important;
    border-style: none !important;
    border-color: transparent !important;
    border-top: none !important;
    border-right: none !important;
    border-bottom: none !important;
    border-left: none !important;
    border-block: none !important;
    border-inline: none !important;
    border-image: none !important;
    outline: none !important;
    outline-width: 0 !important;
    outline-style: none !important;
    outline-color: transparent !important;
    box-shadow: none !important;
    padding: 0 !important;
    padding-top: 0 !important;
    padding-right: 0 !important;
    padding-bottom: 0 !important;
    padding-left: 0 !important;
    padding-block: 0 !important;
    padding-inline: 0 !important;
    margin: 0 !important;
    content: none !important;
  }
}

/* Enforce unified gap for nested elements inside cards */
/* Note: We don't remove padding/margin as nested elements may need them for layout */
/* But we ensure gap is consistent across all card types */
[class*="-card"] [class*="__"],
[class*="-metric"] [class*="__"],
[class*="-item"]:not(.product-entry__benefit):not(.product-entry__action) [class*="__"],
[class*="-row"] [class*="__"],
.section-card [class*="__"],
.info-row [class*="__"],
.overview-card [class*="__"],
.analytics-metric [class*="__"],
.contact-card [class*="__"],
.event-card [class*="__"],
.event-item [class*="__"],
.financial-card [class*="__"],
.financial-metric [class*="__"],
.solution-card [class*="__"],
.solution-item [class*="__"],
.map-card [class*="__"],
.network-card [class*="__"],
.product-card [class*="__"],
.product-entry [class*="__"],
.product-reference [class*="__"],
.chart-card [class*="__"],
.fallback-card [class*="__"],
.fallback-field [class*="__"] {
  /* UNIFIED GAP - Same for all nested elements */
  gap: var(--card-nested-gap) !important;
}

/* IMPORTANT: Override the above rule for actual cards - cards are NOT nested elements */
/* Cards don't have __ in their class names (they're top-level like .contact-card) */
/* So the rule above won't affect them, and this rule ensures they have borders */

/* ===== REMOVE BORDERS FROM GRID/CONTAINER ELEMENTS ===== */
/* Grid containers and collection elements should have NO borders */
/* When inside masonry-item, these wrappers are transparent (display: contents) */
/* When standalone, they still need grid layout */
[class*="-grid"]:not(.masonry-item [class*="-grid"]),
[class*="-metrics"]:not(.masonry-item [class*="-metrics"]),
[class*="-collection"]:not(.masonry-item [class*="-collection"]),
[class*="-matrix"]:not(.masonry-item [class*="-matrix"]),
[class*="-list"]:not(.masonry-item [class*="-list"]),
[class*="-layout"]:not(.masonry-item [class*="-layout"]),
.info-matrix:not(.masonry-item .info-matrix),
.overview-grid:not(.masonry-item .overview-grid),
.analytics-metrics:not(.masonry-item .analytics-metrics),
.contact-grid:not(.masonry-item .contact-grid),
.contact-collection:not(.masonry-item .contact-collection),
.section-list:not(.masonry-item .section-list),
.event-list:not(.masonry-item .event-list),
.financials-grid:not(.masonry-item .financials-grid),
.solutions-list:not(.masonry-item .solutions-list),
.product-grid:not(.masonry-item .product-grid),
.product-layout:not(.masonry-item .product-layout),
.network-grid:not(.masonry-item .network-grid),
.map-grid:not(.masonry-item .map-grid),
.chart-section__list:not(.masonry-item .chart-section__list),
.chart-section__split:not(.masonry-item .chart-section__split) {
  border: none !important;
  border-radius: 0 !important;
  box-shadow: none !important;
  background: transparent !important;
  /* Grid gap - GLOBALLY ENFORCED */
  gap: var(--section-card-gap) !important;
}

/* ===== UNIFIED CARD ENFORCEMENT ===== */
/* ALL CARDS USE IDENTICAL STYLING - NO VARIATIONS ALLOWED */
/* This ensures 100% consistency across all card types */

/* Universal card selector - catches ALL card types and variants */
/* NOTE: .ai-card-surface is excluded so the hero card can keep its own palette */
[class*="-card"]:not([class*="__"]):not(.ai-card-surface),
[class*="-metric"]:not([class*="__"]),
[class*="-item"]:not([class*="__"]):not(.product-entry__benefit):not(.product-entry__action),
[class*="-row"]:not([class*="__"]),
.section-card,
.section-card--quotation,
.section-card--reference,
.section-card--metric,
.section-card--list,
.info-row,
.overview-card,
.analytics-metric,
.contact-card,
.event-card,
.event-item,
.financial-card,
.financial-metric,
.solution-card,
.solution-item,
.map-card,
.network-card,
.product-card,
.product-card--references,
.product-entry,
.product-reference,
.chart-card,
.chart-card--pie,
.chart-card--legend,
.fallback-card,
.fallback-field {
  /* Shared mixin guarantees every section item inherits the same tokenized skin */
  @include surface-section-item-base;
  
  /* UNIFIED HOVER STATE - Section items use section-item hover */
  &:hover {
    @include surface-section-item-hover;
  }
  
  /* UNIFIED FOCUS STATE - Same for all cards */
  &:focus-visible {
    outline: 2px solid rgba(255, 121, 0, 0.6) !important;
    outline-offset: 2px !important;
    border-color: rgba(255, 121, 0, 0.5) !important;
  }
}

/* Grid gap is enforced above in "REMOVE BORDERS FROM GRID/CONTAINER ELEMENTS" */

/* ===== CARD TITLE/LABEL FONT ENFORCEMENT ===== */
/* Replace all legacy font variables with main variables */

/* Card Titles - UNIFIED COLORS */
[class*="__title"]:not([class*="__subtitle"]):not([class*="__meta"]):not(.solution-card__title):not(.map-card__title),
.product-card__title,
.contact-card__name,
.event-title,
.section-card__label {
  font-size: var(--card-title-font-size) !important;
  font-weight: var(--card-title-font-weight) !important;
  letter-spacing: var(--card-title-letter-spacing) !important;
  line-height: var(--card-title-line-height) !important;
  color: var(--card-text-primary) !important;
}

/* Solution and Map card titles use reduced value size for consistency */
.solution-card__title,
.map-card__title {
  font-size: calc(var(--card-value-font-size) - 2px) !important;
  font-weight: var(--card-value-font-weight) !important;
  letter-spacing: var(--card-value-letter-spacing) !important;
  line-height: var(--card-value-line-height) !important;
  color: var(--card-text-primary) !important;
}

/* Card Labels - UNIFIED COLORS */
[class*="__label"]:not([class*="__meta"]),
.overview-card__label,
.analytics-metric__label,
.info-row__label,
.financial-label,
.event-date {
  font-size: var(--card-label-font-size) !important;
  font-weight: var(--card-label-font-weight) !important;
  letter-spacing: var(--card-label-letter-spacing) !important;
  line-height: var(--card-label-line-height) !important;
  text-transform: var(--card-label-text-transform) !important;
  color: var(--card-text-label) !important;
}

/* Card Values - UNIFIED COLORS */
[class*="__value"],
.overview-card__value,
.analytics-metric__value,
.info-row__value,
.financial-value,
.network-card__value {
  font-size: calc(var(--card-value-font-size) - 2px) !important;
  font-weight: var(--card-value-font-weight) !important;
  letter-spacing: var(--card-value-letter-spacing) !important;
  line-height: var(--card-value-line-height) !important;
  color: var(--card-text-primary) !important;
}

/* Card Subtitles - UNIFIED COLORS */
[class*="__subtitle"],
[class*="__description"],
[class*="__role"],
.contact-card__role,
.event-description {
  font-size: var(--card-subtitle-font-size) !important;
  font-weight: var(--card-subtitle-font-weight) !important;
  letter-spacing: var(--card-subtitle-letter-spacing) !important;
  line-height: var(--card-subtitle-line-height) !important;
  color: var(--card-text-secondary) !important;
}

/* Solution card description uses subtitle size */
.solution-card__description {
  font-size: var(--card-subtitle-font-size) !important;
  font-weight: var(--card-subtitle-font-weight) !important;
  letter-spacing: var(--card-subtitle-letter-spacing) !important;
  line-height: var(--card-subtitle-line-height) !important;
  color: var(--card-text-secondary) !important;
}

/* Card Meta - UNIFIED COLORS */
[class*="__meta"],
[class*="__time"],
[class*="__date"],
.overview-card__meta,
.analytics-metric__meta,
.event-time {
  font-size: var(--card-meta-font-size) !important;
  font-weight: var(--card-meta-font-weight) !important;
  color: var(--card-meta-color) !important;
}

/* Solution card benefit text uses meta font size */
.solution-card__benefit-text {
  font-size: var(--card-meta-font-size) !important;
  font-weight: var(--card-meta-font-weight) !important;
  letter-spacing: var(--card-meta-letter-spacing, 0.01em) !important;
  line-height: var(--card-meta-line-height) !important;
  color: var(--card-text-secondary) !important;
}

/* ===== REMOVE LEGACY FONT VARIABLES ===== */
/* Force replacement of all legacy font variables */

/* Replace --font-section-* with main variables */
[class*="__title"],
[class*="__label"],
[class*="__value"],
[class*="__subtitle"],
[class*="__description"],
[class*="__meta"],
[class*="__role"],
[class*="__time"],
[class*="__date"] {
  /* Remove legacy font variables by forcing main variables */
}

/* ===== REMOVE ALL LOCAL OVERRIDES ===== */
/* Remove any custom padding/border/radius/color/background overrides */
/* This ensures all cards use only the global variables */

.ai-section {
  /* Remove custom padding variables */
  --section-padding-y: var(--section-padding) !important;
  --section-padding-x: var(--section-padding) !important;
  --section-padding: var(--section-padding) !important;
  
  /* Remove custom border variables */
  --section-border-radius: var(--card-border-radius) !important;
  
  /* Remove custom gap variables */
  --section-gap: var(--section-card-gap) !important;
  --section-gap-internal: var(--section-card-gap) !important;
}

/* .section-block is used standalone - keep its border */
.section-block:not(.masonry-item .section-block) {
  /* Remove custom padding */
  padding: var(--section-padding) !important;
  
  /* Remove custom border */
  border: var(--card-border) !important;
  border-radius: var(--card-border-radius) !important;
  
  /* Remove custom gap */
  gap: var(--section-card-gap) !important;
}

/* ===== AI CARD HEADER AND BODY - INVISIBLE CONTAINERS ===== */
/* These containers should not be visible - they're structural only */
.ai-card-header,
.ai-card-body {
  /* INVISIBLE CONTAINERS - No visual styling */
  /* NO PADDING - completely removed */
  padding: 0 !important;
  padding-top: 0 !important;
  padding-bottom: 0 !important;
  padding-left: 0 !important;
  padding-right: 0 !important;
  padding-block: 0 !important;
  padding-block-start: 0 !important;
  padding-block-end: 0 !important;
  padding-inline: 0 !important;
  padding-inline-start: 0 !important;
  padding-inline-end: 0 !important;
  margin: 0 !important;
  /* NO BORDER - completely invisible */
  border: none !important;
  border-top: none !important;
  border-bottom: none !important;
  border-left: none !important;
  border-right: none !important;
  border-width: 0 !important;
  border-style: none !important;
  border-color: transparent !important;
  border-image: none !important;
  border-block: none !important;
  border-block-start: none !important;
  border-block-end: none !important;
  border-inline: none !important;
  border-inline-start: none !important;
  border-inline-end: none !important;
  background: transparent !important;
  background-color: transparent !important;
  backdrop-filter: none !important;
  box-shadow: none !important;
  border-radius: 0 !important;
  /* NO OUTLINE - no visual styling */
  outline: none !important;
  outline-offset: 0 !important;
  outline-width: 0 !important;
  outline-style: none !important;
  outline-color: transparent !important;
}

.ai-card-header::before,
.ai-card-header::after,
.ai-card-body::before,
.ai-card-body::after {
  display: none !important;
  border: none !important;
  border-top: none !important;
  border-bottom: none !important;
  border-left: none !important;
  border-right: none !important;
  border-width: 0 !important;
  border-style: none !important;
  border-color: transparent !important;
  border-image: none !important;
  border-block: none !important;
  border-inline: none !important;
  padding: 0 !important;
  padding-block: 0 !important;
  padding-inline: 0 !important;
  outline: none !important;
  outline-width: 0 !important;
  outline-style: none !important;
  outline-color: transparent !important;
  box-shadow: none !important;
}

/* Remove border from .section-block when inside .masonry-item */
.masonry-item .section-block {
  border: none !important;
  border-radius: 0 !important;
  padding: 0 !important;
  background: transparent !important;
  box-shadow: none !important;
  gap: var(--section-card-gap) !important;
}

