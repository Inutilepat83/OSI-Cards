@import 'sections-base';
@import 'unified-cards';

/**
 * Section Type System
 * ---------------------------------------------------------------------------
 * All sections share a common base structure defined here. Each type sets a
 * palette via CSS variables so that light and dark themes stay in sync while
 * preserving individual personalities.
 */

$section-base-shadow: 0 18px 40px color-mix(in srgb, var(--foreground) 8%, transparent);

.section-block {
  --section-accent: var(--color-brand);
  --section-bg: var(--section-surface, var(--section-background, var(--card-section-bg))); /* Dedicated section background */
  --section-border: color-mix(in srgb, var(--section-accent) 30%, transparent); /* Use accent color with transparency */
  --section-header-text: color-mix(in srgb, var(--foreground) 85%, transparent); /* More contrast */
  --section-header-meta: color-mix(in srgb, var(--foreground) 65%, transparent);  /* Improved readability */
  --section-card-background: var(--card-section-card-bg); /* Theme-aware: grey-700 (night) or grey-100 (day) - more contrasty */
  --section-card-border: color-mix(in srgb, var(--color-gray-400) 50%, transparent); /* Grey border for both themes */
  --section-card-hover: var(--card-section-card-bg); /* Theme-aware: grey-700 (night) or grey-100 (day) - more contrasty */
  --section-card-grid-min: 180px; /* More flexible, allows more items per row */
  --section-reflection-opacity: var(--section-reflection-opacity, 0);
  --section-reflection-offset-x: var(--section-reflection-offset-x, 0%);
  --section-reflection-offset-y: var(--section-reflection-offset-y, 0%);
  --section-reflection-angle: var(--section-reflection-angle, 0deg);

  position: relative;
  display: flex;
  flex-direction: column;
  /* COMPACT: Reduced padding and gaps */
  gap: var(--section-card-gap) !important;
  padding: var(--section-padding) !important;
  border-radius: var(--card-border-radius) !important;
  border: var(--section-border) !important; /* DISCRETE: Subtle borders for elegance */
  background: var(--section-bg);
  box-shadow: var(--card-box-shadow);
  /* Enhanced transitions for premium feel */
  transition: border-color 350ms cubic-bezier(0.4, 0, 0.2, 1), 
              background 350ms cubic-bezier(0.4, 0, 0.2, 1), 
              box-shadow 350ms cubic-bezier(0.4, 0, 0.2, 1),
              transform 350ms cubic-bezier(0.4, 0, 0.2, 1);
  overflow: hidden;
  
  /* Subtle entrance animation */
  animation: sectionFadeIn 0.5s cubic-bezier(0.4, 0, 0.2, 1) backwards;
  
  @keyframes sectionFadeIn {
    from {
      opacity: 0;
      transform: translateY(10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  /* Minimalistic hover effect */
  &:hover {
    transform: translateY(-2px);
    box-shadow: var(--card-box-shadow-hover),
                0 0 0 1px color-mix(in srgb, var(--section-accent) 15%, transparent);
    border-color: color-mix(in srgb, var(--section-accent) 30%, transparent);
  }
}

.section-block__header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: calc(var(--card-gap) * 0.75); /* COMPACT: Reduced from full gap */
  flex-wrap: wrap;
}

.section-block__title {
  /* GLOBALLY ENFORCED: Use main variables for typography */
  font-size: var(--section-title-font-size) !important;
  font-weight: var(--section-title-font-weight) !important;
  letter-spacing: var(--section-title-letter-spacing) !important;
  line-height: var(--section-title-line-height) !important;
  color: var(--card-text-primary) !important;
  padding: 0 !important;
  margin: 0 !important;
  transition: color 0.22s ease;
  
  /* Minimalistic hover */
  .section-block:hover & {
    color: color-mix(in srgb, var(--card-text-primary) 90%, var(--section-accent) 10%);
  }
}

.section-block__subtitle {
  font-size: var(--font-section-description);
  color: var(--section-header-meta);
  margin: 0;
}

.section-block__badge {
  display: inline-flex;
  align-items: center;
  gap: calc(var(--card-gap) * 0.75); /* COMPACT: Reduced from full gap */
  padding: calc(var(--tag-padding-y-sm) * 0.75) calc(var(--tag-padding-x) * 0.875); /* COMPACT: Reduced padding */
  border-radius: 999px;
  border: none !important;
  /* NO BORDER (only cards have borders) */
  background: color-mix(in srgb, var(--section-accent) 12%, transparent);
  font-size: var(--font-section-meta);
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.08em;
  color: color-mix(in srgb, var(--section-accent) 80%, var(--foreground) 20%);
}

.section-grid {
  @include section-responsive-grid(var(--section-grid-min-width), var(--section-card-gap));
}

.section-list {
  display: flex;
  flex-direction: column;
  gap: var(--section-card-gap);
}

.section-card {
  @include card;
  /* All properties (padding, border, background, border-radius, hover) are set by @include card */
  /* Matches: rounded-3xl border border-border/40 bg-card/70 p-5 */
  /* Background is forced by @include card with !important */
}

.section-card--metric {
  min-height: auto !important;
  height: auto !important;
  display: flex;
  flex-direction: column;
  gap: var(--card-gap);
  
  /* Remove any minimum height constraints to allow perfect content fit */
  & > * {
    flex-shrink: 0;
  }
}

.section-card__label {
  @extend %unified-card-label;
  display: flex;
  align-items: center;
  gap: calc(var(--card-gap) * 0.75); /* COMPACT: Reduced from full gap */
  text-transform: capitalize;

  > lucide-icon {
    color: color-mix(in srgb, var(--section-accent) 70%, transparent);
    filter: none; /* Removed drop-shadow */
  }
}

.section-card__value {
  @extend %unified-card-value;
  font-size: calc(var(--card-value-font-size) + 4px) !important; /* Bigger font */
  font-weight: var(--card-value-font-weight) !important;
  letter-spacing: var(--card-value-letter-spacing) !important;
  line-height: var(--card-value-line-height) !important;
  color: var(--card-text-primary) !important;
  transition: color 0.25s ease;
  text-shadow: none;
  display: flex;
  align-items: center;
  gap: calc(var(--card-gap) * 0.75);
  
  > lucide-icon {
    flex-shrink: 0;
    opacity: 0.85;
  }
}

.section-card__meta {
  display: flex;
  align-items: center;
  gap: calc(var(--card-gap) * 0.75); /* COMPACT: Reduced from full gap */
  font-size: var(--font-section-meta);
  color: color-mix(in srgb, var(--foreground) 85%, transparent);
  line-height: 1.2; /* COMPACT: Tight line-height */
}

.section-card__progress {
  width: 100%;
  height: 6px;
  border-radius: var(--radius-xs);
  background: color-mix(in srgb, var(--section-accent) 12%, transparent);
  overflow: hidden;

  &-bar {
    height: 100%;
    border-radius: inherit;
    background: color-mix(in srgb, var(--section-accent) 72%, transparent);
  }
}

.section-empty {
  /* COMPACT: Reduced padding */
  padding: calc(var(--card-padding) * 1.5);
  border-radius: var(--section-card-border-radius);
  border: none !important;
  /* CLEAN: No borders on empty states - only sections and cards have borders */
  background: color-mix(in srgb, var(--section-accent) 10%, transparent);
  text-align: center;
  color: color-mix(in srgb, var(--foreground) 85%, transparent);
  min-height: auto;
  /* COMPACT: No minimum height */
}

/* -------------------------------------------------------------------------- */
/* Section Type Modifiers                                                     */
/* -------------------------------------------------------------------------- */

.section-block--metrics {
  --section-accent: var(--color-brand);
  --section-background: var(--card-section-bg); /* Theme-aware: grey-800 (night) or grey-50 (day) */
  --section-card-background: var(--card-section-card-bg); /* Theme-aware: grey-700 (night) or grey-100 (day) - more contrasty */
}

.section-block--insights {
  --section-accent: color-mix(in srgb, var(--color-brand) 65%, var(--foreground) 35%);
  --section-background: color-mix(in srgb, var(--card) 94%, transparent);
  --section-card-background: var(--card-section-card-bg); /* Theme-aware: grey-700 (night) or grey-100 (day) - more contrasty */
}

.section-block--list {
  --section-accent: color-mix(in srgb, var(--color-brand) 45%, var(--foreground) 55%);
  --section-card-grid-min: 180px;
  --section-background: color-mix(in srgb, var(--card) 93%, transparent);
}

.section-block--contacts {
  --section-accent: color-mix(in srgb, var(--color-brand) 70%, var(--foreground) 30%);
  --section-card-grid-min: 180px; /* More compact */
  --section-card-background: var(--card-section-card-bg); /* Theme-aware: grey-700 (night) or grey-100 (day) - more contrasty */
}

.section-block--timeline {
  --section-accent: color-mix(in srgb, var(--color-brand) 55%, var(--foreground) 45%);
  --section-card-grid-min: 200px; /* More compact */
}

.section-block--map {
  --section-accent: color-mix(in srgb, var(--color-brand) 50%, var(--foreground) 50%);
  --section-card-grid-min: 220px; /* More compact */
  --section-background: color-mix(in srgb, var(--card) 90%, transparent);
}

.section-block--network {
  --section-accent: color-mix(in srgb, var(--color-brand) 60%, var(--foreground) 40%);
  --section-card-grid-min: 200px; /* More compact */
}

.section-block--product {
  --section-accent: color-mix(in srgb, var(--color-brand) 75%, var(--foreground) 25%);
  --section-background: color-mix(in srgb, var(--card) 88%, transparent);
  --section-card-background: var(--card-section-card-bg); /* Theme-aware: grey-700 (night) or grey-100 (day) - more contrasty */
}

.section-block--financial {
  --section-accent: color-mix(in srgb, var(--color-brand) 40%, var(--foreground) 60%);
  --section-card-background: var(--card-section-card-bg); /* Theme-aware: grey-700 (night) or grey-100 (day) - more contrasty */
}

.section-block--solutions {
  --section-accent: color-mix(in srgb, var(--color-brand) 65%, var(--foreground) 35%);
  --section-card-grid-min: 220px; /* More compact */
  --section-card-background: var(--card-section-card-bg); /* Theme-aware: grey-700 (night) or grey-100 (day) - more contrasty */
}

@media (max-width: 768px) {
  .section-block {
    gap: var(--card-gap);
    padding: clamp(12px, 2.5vw, 18px); /* Increased by 2px */
  }

  .section-grid {
    grid-template-columns: repeat(auto-fit, minmax(var(--section-grid-min-width), 1fr));
    gap: var(--section-grid-gap-mobile);
  }

  .section-list {
    gap: var(--section-grid-gap-mobile);
  }
}

