@import 'sections-base';
@import 'unified-cards';

/**
 * Section Type System
 * ---------------------------------------------------------------------------
 * All sections share a common base structure defined here. Each type sets a
 * palette via CSS variables so that light and dark themes stay in sync while
 * preserving individual personalities.
 */

$section-base-shadow: 0 18px 40px color-mix(in srgb, var(--foreground) 8%, transparent);

.section-block {
  --section-accent: var(--color-brand);
  --section-background: var(--card-section-bg); /* Theme-aware: grey-800 (night) or grey-50 (day) */
  --section-border: color-mix(in srgb, var(--section-accent) 30%, transparent); /* Use accent color with transparency */
  --section-header-text: color-mix(in srgb, var(--foreground) 85%, transparent); /* More contrast */
  --section-header-meta: color-mix(in srgb, var(--foreground) 65%, transparent);  /* Improved readability */
  --section-card-background: var(--card-section-card-bg); /* Theme-aware: grey-700 (night) or grey-100 (day) - more contrasty */
  --section-card-border: color-mix(in srgb, var(--color-gray-400) 50%, transparent); /* Grey border for both themes */
  --section-card-hover: var(--card-section-card-bg); /* Theme-aware: grey-700 (night) or grey-100 (day) - more contrasty */
  --section-card-grid-min: 180px; /* More flexible, allows more items per row */
  --section-reflection-opacity: var(--section-reflection-opacity, 0);
  --section-reflection-offset-x: var(--section-reflection-offset-x, 0%);
  --section-reflection-offset-y: var(--section-reflection-offset-y, 0%);
  --section-reflection-angle: var(--section-reflection-angle, 0deg);

  position: relative;
  display: flex;
  flex-direction: column;
  gap: 18px;                           // Increased from calc(var(--spacing-7xl) - 4px)
  padding: clamp(18px, 2vw, 26px);    // Increased from clamp(14px, 2vw, 22px)
  border-radius: var(--radius-lg);
  border: 1px solid var(--section-border);  // Changed from 0.5px
  background: var(--section-background);
  box-shadow: var(--section-block-shadow); /* Theme-aware shadow - less visible in day mode */
  transition: border-color 0.2s ease, background 0.2s ease, box-shadow 0.2s ease;
  overflow: hidden; /* Ensure reflection doesn't overflow */

  /* Light flare effect - makes surface appear to catch light */
  &::before {
    content: '';
    position: absolute;
    inset: 0;
    pointer-events: none;
    border-radius: inherit;
    opacity: var(--section-reflection-opacity, 0);
    background: linear-gradient(
      calc(135deg + var(--section-reflection-angle, 0deg)),
      color-mix(in srgb, var(--color-white) 3%, transparent) 0%,
      color-mix(in srgb, var(--color-white) 6%, transparent) calc(20% + var(--section-reflection-offset-x, 0%)),
      color-mix(in srgb, var(--color-white) 8%, transparent) calc(40% + var(--section-reflection-offset-x, 0%)),
      color-mix(in srgb, var(--color-white) 5%, transparent) calc(60% + var(--section-reflection-offset-x, 0%)),
      color-mix(in srgb, var(--color-white) 2%, transparent) calc(80% + var(--section-reflection-offset-x, 0%)),
      transparent 100%
    );
    transform: translate(
      calc(var(--section-reflection-offset-x, 0%) * 0.2),
      calc(var(--section-reflection-offset-y, 0%) * 0.2)
    );
    transition: opacity 0.2s ease, transform 0.15s ease-out, background 0.15s ease-out;
    z-index: 1;
    mix-blend-mode: soft-light; /* Creates a subtle lightening effect */
  }
}

.section-block__header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: var(--spacing-3xl);
  flex-wrap: wrap;
}

.section-block__title {
  font-size: var(--font-section-title);
  font-weight: 700;
  color: var(--section-header-text);
  letter-spacing: 0.02em;
  margin: 0;
}

.section-block__subtitle {
  font-size: var(--font-section-description);
  color: var(--section-header-meta);
  margin: 0;
}

.section-block__badge {
  display: inline-flex;
  align-items: center;
  gap: var(--spacing-sm);
  padding: var(--spacing-xs) var(--spacing-2xl);
  border-radius: var(--radius-full);
  border: 1px solid color-mix(in srgb, var(--section-accent) 30%, transparent);
  background: color-mix(in srgb, var(--section-accent) 12%, transparent);
  font-size: var(--font-section-meta);
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.08em;
  color: color-mix(in srgb, var(--section-accent) 80%, var(--foreground) 20%);
}

.section-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(var(--section-card-grid-min), 1fr));
  gap: var(--section-grid-gap);
  width: 100%;
}

.section-list {
  display: flex;
  flex-direction: column;
  gap: var(--section-grid-gap);
}

.section-card {
  @include card;
  /* All properties (padding, border, background, border-radius, hover) are set by @include card */
  /* Matches: rounded-3xl border border-border/40 bg-card/70 p-5 */
  /* Background is forced by @include card with !important */
}

.section-card__label {
  @extend %unified-card-label;
  display: flex;
  align-items: center;
  gap: var(--card-element-gap-sm);
  margin-bottom: var(--spacing-xs);
  text-transform: capitalize;

  > lucide-icon {
    color: color-mix(in srgb, var(--section-accent) 70%, transparent);
    filter: none; /* Removed drop-shadow */
  }
}

.section-card__value {
  @extend %unified-card-value;
  margin-bottom: var(--spacing-xs);
  letter-spacing: -0.02em;
  transition: color 0.25s ease;
  text-shadow: none;
}

.section-card__meta {
  display: flex;
  align-items: center;
  gap: var(--spacing-sm);
  font-size: var(--font-section-meta);
  color: color-mix(in srgb, var(--foreground) 85%, transparent);
}

.section-card__progress {
  width: 100%;
  height: 6px;
  border-radius: var(--radius-xs);
  background: color-mix(in srgb, var(--section-accent) 12%, transparent);
  overflow: hidden;

  &-bar {
    height: 100%;
    border-radius: inherit;
    background: color-mix(in srgb, var(--section-accent) 72%, transparent);
  }
}

.section-empty {
  padding: var(--spacing-8xl) var(--spacing-3xl);
  border-radius: var(--radius-lg);
  border: 1px dashed color-mix(in srgb, var(--section-accent) 32%, transparent);
  background: color-mix(in srgb, var(--section-accent) 10%, transparent);
  text-align: center;
  color: color-mix(in srgb, var(--foreground) 85%, transparent);
}

/* -------------------------------------------------------------------------- */
/* Section Type Modifiers                                                     */
/* -------------------------------------------------------------------------- */

.section-block--metrics {
  --section-accent: var(--color-brand);
  --section-background: var(--card-section-bg); /* Theme-aware: grey-800 (night) or grey-50 (day) */
  --section-card-background: var(--card-section-card-bg); /* Theme-aware: grey-700 (night) or grey-100 (day) - more contrasty */
}

.section-block--insights {
  --section-accent: color-mix(in srgb, var(--color-brand) 65%, var(--foreground) 35%);
  --section-background: color-mix(in srgb, var(--card) 94%, transparent);
  --section-card-background: var(--card-section-card-bg); /* Theme-aware: grey-700 (night) or grey-100 (day) - more contrasty */
}

.section-block--list {
  --section-accent: color-mix(in srgb, var(--color-brand) 45%, var(--foreground) 55%);
  --section-card-grid-min: 180px;
  --section-background: color-mix(in srgb, var(--card) 93%, transparent);
}

.section-block--contacts {
  --section-accent: color-mix(in srgb, var(--color-brand) 70%, var(--foreground) 30%);
  --section-card-grid-min: 180px; /* More compact */
  --section-card-background: var(--card-section-card-bg); /* Theme-aware: grey-700 (night) or grey-100 (day) - more contrasty */
}

.section-block--timeline {
  --section-accent: color-mix(in srgb, var(--color-brand) 55%, var(--foreground) 45%);
  --section-card-grid-min: 200px; /* More compact */
}

.section-block--map {
  --section-accent: color-mix(in srgb, var(--color-brand) 50%, var(--foreground) 50%);
  --section-card-grid-min: 220px; /* More compact */
  --section-background: color-mix(in srgb, var(--card) 90%, transparent);
}

.section-block--network {
  --section-accent: color-mix(in srgb, var(--color-brand) 60%, var(--foreground) 40%);
  --section-card-grid-min: 200px; /* More compact */
}

.section-block--product {
  --section-accent: color-mix(in srgb, var(--color-brand) 75%, var(--foreground) 25%);
  --section-background: color-mix(in srgb, var(--card) 88%, transparent);
  --section-card-background: var(--card-section-card-bg); /* Theme-aware: grey-700 (night) or grey-100 (day) - more contrasty */
}

.section-block--financial {
  --section-accent: color-mix(in srgb, var(--color-brand) 40%, var(--foreground) 60%);
  --section-card-background: var(--card-section-card-bg); /* Theme-aware: grey-700 (night) or grey-100 (day) - more contrasty */
}

.section-block--solutions {
  --section-accent: color-mix(in srgb, var(--color-brand) 65%, var(--foreground) 35%);
  --section-card-grid-min: 220px; /* More compact */
  --section-card-background: var(--card-section-card-bg); /* Theme-aware: grey-700 (night) or grey-100 (day) - more contrasty */
}

@media (max-width: 768px) {
  .section-block {
    gap: var(--spacing-5xl);
    padding: clamp(12px, 2.5vw, 18px); /* Increased by 2px */
  }

  .section-grid {
    grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
    gap: var(--section-grid-gap-mobile);
  }

  .section-list {
    gap: var(--section-grid-gap-mobile);
  }
}

