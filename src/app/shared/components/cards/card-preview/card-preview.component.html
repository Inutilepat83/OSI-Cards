
  <div class="preview-body" [attr.aria-busy]="isGenerating">
    <ng-container *ngIf="isGenerating || !isInitialized; else previewStates">
      <div class="preview-loading" role="status">
        <div class="preview-spinner"></div>
        <div>
          <p class="preview-loading-title">
            {{ !isInitialized ? 'Initializing System…' : 'Generating Card…' }}
          </p>
          <p class="preview-loading-subtitle">
            {{ !isInitialized ? 'Loading templates and services' : 'Processing your configuration' }}
          </p>
        </div>
      </div>
    </ng-container>

    <ng-template #previewStates>
      <ng-container *ngIf="generatedCard; else previewEmpty">
        <app-ai-card-renderer
          [cardConfig]="generatedCard"
          [isFullscreen]="isFullscreen"
          (cardInteraction)="onCardInteraction($event)"
          (fieldInteraction)="onFieldInteraction($event)">
        </app-ai-card-renderer>
      </ng-container>
    </ng-template>

    <ng-template #previewEmpty>
      <div class="preview-empty">
        <div class="preview-empty-icon" aria-hidden="true">
          <div class="code-icon w-8 h-8"></div>
        </div>
        <div class="preview-empty-copy">
          <p class="preview-empty-title">No Card Preview</p>
          <p class="preview-empty-subtitle">
            Enter a valid JSON configuration or load a template to see your card design render in real time.
          </p>
        </div>
        <div class="preview-empty-hints">
          <div class="preview-empty-hint">
            <div class="hint-dot bg-green-500"></div>
            <span>Valid JSON auto-generates layouts</span>
          </div>
          <div class="preview-empty-hint">
            <div class="hint-dot bg-blue-500"></div>
            <span>Magnetic tilt responds to cursor position</span>
          </div>
          <div class="preview-empty-hint">
            <div class="hint-dot bg-purple-500"></div>
            <span>Export high-fidelity PNG snapshots</span>
          </div>
        </div>
      </div>
    </ng-template>
  </div>
