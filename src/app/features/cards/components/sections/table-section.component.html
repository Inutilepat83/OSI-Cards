<div class="table-section" [attr.aria-label]="section.title">
  <div class="section-header" *ngIf="section.title || section.description">
    <h3 class="section-title">{{ section.title }}</h3>
    <p class="section-description" *ngIf="section.description">{{ section.description }}</p>
  </div>

  <div class="table-container" [ngClass]="{ 'responsive': responsive }">
    <table class="data-table" [ngClass]="{ 'striped': striped }">
      <thead>
        <tr>
          <th 
            *ngFor="let column of columns; trackBy: trackByColumnFn"
            [style.width]="column.width"
            [ngClass]="{ 'sortable': sortable && column.sortable }"
            (click)="onSort(column)"
            [attr.aria-sort]="sortColumn === column.key ? (sortDirection === 'asc' ? 'ascending' : 'descending') : 'none'"
          >
            <div class="header-content">
              <span class="header-text">{{ column.header }}</span>
              <i 
                *ngIf="sortable && column.sortable"
                [class]="getSortIcon(column)"
                class="sort-icon"
                aria-hidden="true"
              ></i>
            </div>
          </th>
        </tr>
      </thead>
      
      <tbody>
        <tr 
          *ngFor="let row of rows; trackBy: trackByRowFn"
          class="table-row"
          (click)="onRowClick(row)"
          [attr.tabindex]="0"
          [attr.role]="'button'"
        >
          <td 
            *ngFor="let column of columns; trackBy: trackByColumnFn"
            [ngClass]="getCellClass(row[column.key], column)"
            (click)="onCellClick(row, column, row[column.key]); $event.stopPropagation()"
          >
            <ng-container [ngSwitch]="column.type">
              <!-- Status badge -->
              <span 
                *ngSwitchCase="'status'"
                class="status-badge"
                [ngClass]="'status-' + (row[column.key]?.toString()?.toLowerCase() || '')"
              >
                {{ row[column.key] }}
              </span>
              
              <!-- Icon -->
              <i 
                *ngSwitchCase="'icon'"
                [class]="'icon ' + row[column.key]"
                [attr.aria-label]="row[column.key]"
              ></i>
              
              <!-- Default text -->
              <span *ngSwitchDefault>
                {{ formatCellValue(row[column.key], column) }}
              </span>
            </ng-container>
          </td>
        </tr>
      </tbody>
    </table>
    
    <div class="empty-state" *ngIf="rows.length === 0">
      <i class="fas fa-table" aria-hidden="true"></i>
      <p>No data available</p>
    </div>
  </div>
</div>
