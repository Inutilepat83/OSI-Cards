openapi: 3.1.0
info:
  title: OSI Cards Library API
  version: 1.2.2
  description: |
    OpenAPI documentation for OSI Cards Library - a versatile card generator for sales intelligence agents.
    
    This specification documents:
    - Card configuration schemas
    - Component APIs and interfaces
    - Service interfaces
    - Event schemas
    
    OSI Cards is a frontend library that generates interactive cards from JSON configurations.
    All cards are AI-generated by Large Language Models (LLMs).
  contact:
    name: OSI Cards Support
    url: https://github.com/your-org/osi-cards
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT

servers:
  - url: https://api.example.com/api/v1
    description: Production API (if applicable)
  - url: http://localhost:4200/api/v1
    description: Development API (if applicable)

tags:
  - name: Cards
    description: Card configuration and management
  - name: Sections
    description: Section configuration and types
  - name: Services
    description: Service interfaces and APIs
  - name: Events
    description: Event schemas and interactions

paths:
  /cards:
    get:
      tags:
        - Cards
      summary: Get all cards
      description: Retrieve all available card configurations
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/AICardConfig'
    post:
      tags:
        - Cards
      summary: Create a new card
      description: Create a new card configuration
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AICardConfig'
      responses:
        '201':
          description: Card created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AICardConfig'

  /cards/{id}:
    get:
      tags:
        - Cards
      summary: Get card by ID
      description: Retrieve a specific card configuration by ID
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AICardConfig'
        '404':
          description: Card not found

  /cards/validate:
    post:
      tags:
        - Cards
      summary: Validate card configuration
      description: Validate a card configuration against the schema
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AICardConfig'
      responses:
        '200':
          description: Validation result
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationResult'

components:
  schemas:
    AICardConfig:
      type: object
      required:
        - cardTitle
        - sections
      properties:
        id:
          type: string
          description: Unique identifier for the card (auto-generated if not provided)
          example: "card-123"
        cardTitle:
          type: string
          description: Main title of the card (required)
          example: "Company Overview"
          maxLength: 150
        cardSubtitle:
          type: string
          description: Subtitle or secondary title
          example: "Q4 2024"
        cardType:
          type: string
          description: Card type for categorization
          example: "company"
        description:
          type: string
          description: Description of the card
          maxLength: 500
        columns:
          type: integer
          description: Number of columns for layout
          enum: [1, 2, 3]
          default: 2
        sections:
          type: array
          description: Array of card sections (required)
          items:
            $ref: '#/components/schemas/CardSection'
          minItems: 1
          maxItems: 15
        actions:
          type: array
          description: Array of card actions (buttons)
          items:
            $ref: '#/components/schemas/CardAction'
          maxItems: 8
        meta:
          type: object
          description: Additional metadata
          additionalProperties: true
        processedAt:
          type: integer
          format: int64
          description: Timestamp when card was processed
      example:
        cardTitle: "Company Overview"
        cardSubtitle: "Q4 2024"
        cardType: "company"
        columns: 2
        sections:
          - type: "info"
            title: "Company Information"
            fields:
              - label: "Industry"
                value: "Technology"
              - label: "Founded"
                value: "2010"

    CardSection:
      type: object
      required:
        - title
        - type
      properties:
        id:
          type: string
          description: Unique identifier for the section
        title:
          type: string
          description: Section title (required)
        type:
          type: string
          description: Section type determines rendering component
          enum:
            - info
            - timeline
            - analytics
            - metrics
            - contact-card
            - network-card
            - map
            - financials
            - locations
            - event
            - project
            - list
            - table
            - chart
            - product
            - solutions
            - overview
            - stats
            - quotation
            - reference
            - text-reference
            - text-ref
            - brand-colors
        description:
          type: string
        subtitle:
          type: string
        columns:
          type: integer
        colSpan:
          type: integer
        width:
          type: integer
        collapsed:
          type: boolean
        emoji:
          type: string
        fields:
          type: array
          items:
            $ref: '#/components/schemas/CardField'
          maxItems: 30
        items:
          type: array
          items:
            $ref: '#/components/schemas/CardItem'
        chartType:
          type: string
          enum: [bar, line, pie, doughnut]
        chartData:
          type: object
          properties:
            labels:
              type: array
              items:
                type: string
            datasets:
              type: array
              items:
                type: object
        meta:
          type: object
          additionalProperties: true
      additionalProperties: true

    CardField:
      type: object
      properties:
        id:
          type: string
        label:
          type: string
        title:
          type: string
        value:
          oneOf:
            - type: string
            - type: number
            - type: boolean
            - type: "null"
        icon:
          type: string
        format:
          type: string
          enum: [currency, percentage, number, text]
        percentage:
          type: number
        change:
          type: number
        trend:
          type: string
          enum: [up, down, stable, neutral]
        description:
          type: string
        status:
          type: string
          enum: [completed, in-progress, pending, cancelled, active, inactive, warning]
        priority:
          type: string
          enum: [high, medium, low]
        email:
          type: string
        phone:
          type: string
        address:
          type: string
        coordinates:
          type: object
          properties:
            lat:
              type: number
            lng:
              type: number
        contact:
          $ref: '#/components/schemas/Contact'
        meta:
          type: object
          additionalProperties: true
      additionalProperties: true

    CardItem:
      type: object
      required:
        - title
      properties:
        id:
          type: string
        title:
          type: string
          description: Item title (required)
        description:
          type: string
        icon:
          type: string
          description: Icon identifier (emoji, icon name, or image URL)
        value:
          oneOf:
            - type: string
            - type: number
        status:
          type: string
        meta:
          type: object
          additionalProperties: true

    CardAction:
      oneOf:
        - $ref: '#/components/schemas/MailCardAction'
        - $ref: '#/components/schemas/WebsiteCardAction'
        - $ref: '#/components/schemas/AgentCardAction'
        - $ref: '#/components/schemas/QuestionCardAction'
      discriminator:
        propertyName: type

    MailCardAction:
      type: object
      required:
        - label
        - type
        - email
      properties:
        id:
          type: string
        label:
          type: string
        type:
          type: string
          enum: [mail]
        icon:
          type: string
        variant:
          type: string
          enum: [primary, secondary, outline, ghost]
        email:
          $ref: '#/components/schemas/EmailConfig'
        meta:
          type: object
          additionalProperties: true

    WebsiteCardAction:
      type: object
      required:
        - label
        - type
        - url
      properties:
        id:
          type: string
        label:
          type: string
        type:
          type: string
          enum: [website]
        icon:
          type: string
        url:
          type: string
          format: uri
        variant:
          type: string
          enum: [primary, secondary, outline, ghost]
        meta:
          type: object
          additionalProperties: true

    AgentCardAction:
      type: object
      required:
        - label
        - type
      properties:
        id:
          type: string
        label:
          type: string
        type:
          type: string
          enum: [agent]
        icon:
          type: string
        agentId:
          type: string
        context:
          type: object
          additionalProperties: true
        variant:
          type: string
          enum: [primary, secondary, outline, ghost]
        meta:
          type: object
          additionalProperties: true

    QuestionCardAction:
      type: object
      required:
        - label
        - type
      properties:
        id:
          type: string
        label:
          type: string
        type:
          type: string
          enum: [question]
        icon:
          type: string
        question:
          type: string
        variant:
          type: string
          enum: [primary, secondary, outline, ghost]
        meta:
          type: object
          additionalProperties: true

    EmailConfig:
      type: object
      required:
        - contact
        - subject
        - body
      properties:
        contact:
          $ref: '#/components/schemas/Contact'
        subject:
          type: string
        body:
          type: string
        to:
          oneOf:
            - type: string
            - type: array
              items:
                type: string
        cc:
          oneOf:
            - type: string
            - type: array
              items:
                type: string
        bcc:
          oneOf:
            - type: string
            - type: array
              items:
                type: string

    Contact:
      type: object
      required:
        - name
        - email
        - role
      properties:
        name:
          type: string
        email:
          type: string
          format: email
        role:
          type: string

    ValidationResult:
      type: object
      properties:
        isValid:
          type: boolean
        errors:
          type: array
          items:
            type: object
            properties:
              path:
                type: string
              message:
                type: string
        warnings:
          type: array
          items:
            type: object
            properties:
              path:
                type: string
              message:
                type: string

    CardUpdateEvent:
      type: object
      properties:
        type:
          type: string
          enum: [created, updated, deleted]
        card:
          $ref: '#/components/schemas/AICardConfig'
        timestamp:
          type: integer
          format: int64
        metadata:
          type: object
          additionalProperties: true

    ProviderStatus:
      type: object
      properties:
        isConnected:
          type: boolean
        lastError:
          type: string
        lastSuccess:
          type: integer
          format: int64
        cardCount:
          type: integer

    CardInteractionEvent:
      type: object
      properties:
        action:
          type: string
        card:
          $ref: '#/components/schemas/AICardConfig'
        metadata:
          type: object
          additionalProperties: true

    FieldInteractionEvent:
      type: object
      properties:
        field:
          $ref: '#/components/schemas/CardField'
        item:
          $ref: '#/components/schemas/CardItem'
        action:
          type: string
        sectionTitle:
          type: string
        metadata:
          type: object
          additionalProperties: true

  parameters:
    CardTypeParam:
      name: cardType
      in: query
      description: Filter cards by type
      schema:
        type: string
      example: "company"

    CardIdParam:
      name: id
      in: path
      required: true
      description: Card identifier
      schema:
        type: string
      example: "card-123"

