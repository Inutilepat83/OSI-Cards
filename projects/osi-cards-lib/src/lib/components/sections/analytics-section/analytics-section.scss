// =====================================================================
// ANALYTICS SECTION - Enhanced Modern Metric Display
// =====================================================================

@use '../../../styles/components/sections/design-system' as *;
@use '../../../styles/components/sections/typography-system' as typo;
@use '../../../styles/components/sections/modern-effects' as effects;
@use '../../../styles/components/sections/component-mixins' as components;

:host {
  display: block;
  width: 100%;
}

// =====================================================================
// SECTION CONTAINER
// =====================================================================

.analytics-container {
  display: flex;
  flex-direction: column;
  gap: var(--section-header-gap);
}

.section-header {
  .section-title {
    @include heading(3);
    margin-bottom: var(--spacing-xs);
  }

  .section-description {
    @include body-text('small');
    color: var(--muted-foreground);
    line-height: var(--leading-relaxed);
  }
}

// =====================================================================
// METRICS GRID - Enhanced Responsive Layout
// =====================================================================

.analytics-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
  gap: var(--spacing-md);

  @media (max-width: 640px) {
    grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
    gap: var(--spacing-sm);
  }
}

// =====================================================================
// METRIC CARD - Enhanced with Modern Effects
// =====================================================================

.metric-card {
  @include card-elevated;
  position: relative;
  padding: var(--spacing-md);
  min-height: 120px;
  display: flex;
  flex-direction: column;
  gap: var(--spacing-sm);
  overflow: hidden;
  transition: all 300ms var(--ease-out);
  cursor: default;

  // Minimalist hover effect
  &:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow-md);

    .metric-value {
      transform: scale(1.05);
      color: var(--accent);
    }

    .metric-progress .progress-fill {
      animation: progressPulse 1s ease-in-out;
    }
  }

  // Focus for accessibility
  &:focus-visible {
    outline: 2px solid var(--accent);
    outline-offset: 2px;
  }
}

// =====================================================================
// METRIC ELEMENTS - Enhanced Typography
// =====================================================================

.metric-header {
  display: flex;
  align-items: flex-start;
  justify-content: space-between;
  gap: var(--spacing-sm);
  margin-bottom: auto; // Push other content down
}

.metric-label {
  @include typo.label-uppercase;
  flex: 1;
  line-height: var(--leading-tight);
  font-size: 0.65rem;
  letter-spacing: 0.8px;
  color: var(--muted-foreground);
}

.metric-value {
  @include typo.number-display-medium;
  margin: var(--spacing-xs) 0;
  font-size: var(--text-2xl);
  letter-spacing: -0.03em;
  font-weight: var(--font-bold);
  color: var(--foreground);
  transition: all 300ms var(--ease-out);
  line-height: 1;
}

// =====================================================================
// TREND INDICATOR - Enhanced with Animations
// =====================================================================

.metric-trend {
  display: inline-flex;
  align-items: center;
  gap: var(--spacing-xs);
  font-size: var(--text-xs);
  font-weight: var(--font-bold);
  flex-shrink: 0;
  padding: 3px 6px;
  border-radius: var(--radius-sm);
  transition: all 200ms var(--ease-out);

  .trend-icon {
    display: inline-block;
    font-size: 12px;
    line-height: 1;
    animation: trendBounce 1.5s ease-in-out infinite;

    &[data-trend="up"]::before {
      content: '↗';
    }
    &[data-trend="down"]::before {
      content: '↘';
    }
    &[data-trend="stable"]::before {
      content: '→';
    }
  }

  .trend-text {
    font-weight: var(--font-bold);
  }

  &.metric-trend--up {
    color: var(--status-success);
    background: var(--status-success-bg);
  }

  &.metric-trend--down {
    color: var(--status-error);
    background: var(--status-error-bg);
  }

  &.metric-trend--stable {
    color: var(--status-warning);
    background: var(--status-warning-bg);
  }

  &.metric-trend--neutral {
    color: var(--muted-foreground);
    background: var(--surface-hover);
  }

  // Hover effect
  .metric-card:hover & {
    transform: scale(1.05);
  }
}

// =====================================================================
// PROGRESS BAR - Enhanced with Smooth Animations
// =====================================================================

.metric-progress {
  position: relative;
  height: 6px;
  background: var(--surface-hover);
  border-radius: var(--radius-full);
  overflow: hidden;
  margin-top: auto;

  .progress-fill {
    height: 100%;
    border-radius: var(--radius-full);
    transition: width 600ms cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
    overflow: hidden;

    // Shimmer effect
    &::after {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg,
        transparent 0%,
        rgba(255, 255, 255, 0.3) 50%,
        transparent 100%
      );
      animation: shimmer 2s infinite;
    }

    &.metric-performance--excellent {
      background: linear-gradient(90deg, var(--status-success) 0%, var(--status-success-bright) 100%);
    }

    &.metric-performance--good {
      background: linear-gradient(90deg, var(--accent) 0%, var(--accent-bright) 100%);
    }

    &.metric-performance--average {
      background: linear-gradient(90deg, var(--status-warning) 0%, var(--status-warning-bright) 100%);
    }

    &.metric-performance--poor {
      background: linear-gradient(90deg, var(--status-error) 0%, var(--status-error-bright) 100%);
    }
  }
}

// =====================================================================
// PERFORMANCE BADGE - Enhanced Visual Design
// =====================================================================

.metric-performance {
  @include components.badge-modern('default');
  font-size: 0.6rem;
  text-transform: capitalize;
  align-self: flex-start;
  margin-top: var(--spacing-xs);
  padding: 3px 8px;
  font-weight: var(--font-semibold);
  letter-spacing: 0.3px;
  transition: all 200ms var(--ease-out);

  &.metric-performance--excellent {
    @include components.badge-modern('success');
  }

  &.metric-performance--good {
    @include components.badge-modern('primary');
  }

  &.metric-performance--average {
    @include components.badge-modern('warning');
  }

  &.metric-performance--poor {
    @include components.badge-modern('error');
  }

  // Hover animation
  .metric-card:hover & {
    transform: translateY(-1px);
    box-shadow: var(--shadow-sm);
  }
}

// =====================================================================
// EMPTY STATE - Enhanced
// =====================================================================

.analytics-empty {
  @include components.empty-state-modern;
  padding: var(--spacing-xl);

  .empty-text {
    @include body-text('base');
    color: var(--muted-foreground);
  }
}

// =====================================================================
// ANIMATIONS
// =====================================================================

@keyframes trendBounce {
  0%, 100% {
    transform: translateY(0);
  }
  50% {
    transform: translateY(-2px);
  }
}

@keyframes shimmer {
  0% {
    left: -100%;
  }
  100% {
    left: 100%;
  }
}

@keyframes progressPulse {
  0%, 100% {
    opacity: 1;
  }
  50% {
    opacity: 0.8;
  }
}

// =====================================================================
// RESPONSIVE
// =====================================================================

@media (max-width: 480px) {
  .analytics-grid {
    grid-template-columns: 1fr;
    gap: var(--spacing-sm);
  }

  .metric-card {
    min-height: 100px;
    padding: var(--spacing-sm);
  }

  .metric-value {
    font-size: var(--text-xl);
  }
}

// =====================================================================
// DARK MODE ENHANCEMENTS
// =====================================================================

@media (prefers-color-scheme: dark) {
  .metric-card {
    &::before {
      background: linear-gradient(90deg, var(--accent) 0%, var(--accent-bright) 100%);
    }

    &:hover {
      box-shadow: var(--shadow-xl);
    }
  }
}
