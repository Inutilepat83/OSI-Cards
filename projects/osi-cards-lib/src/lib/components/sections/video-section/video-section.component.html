<div class="video-section">
  @if (items.length > 0) {
    <div class="video-grid" [class.video-grid--single]="items.length === 1">
      @for (item of items; track trackItem($index, item); let i = $index) {
        <div
          class="video-item"
          [style.--stagger-index]="getItemStaggerIndex(i)"
          [ngClass]="getItemAnimationClass(getItemId(item, i), i)">

          <div
            class="video-container"
            [style.aspect-ratio]="getAspectRatio(item)">

            @if (isPlaying(i)) {
              <!-- Video iframe -->
              <iframe
                [src]="getEmbedUrl(item)"
                class="video-iframe"
                [title]="item.title || 'Video'"
                frameborder="0"
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                allowfullscreen>
              </iframe>
            } @else {
              <!-- Thumbnail with play button -->
              <div
                class="video-thumbnail"
                (click)="playVideo(i)"
                (keydown.enter)="playVideo(i)"
                (keydown.space)="playVideo(i)"
                tabindex="0"
                role="button"
                [attr.aria-label]="'Play video: ' + (item.title || 'Untitled')">

                @if (getThumbnail(item)) {
                  <img
                    [src]="getThumbnail(item)"
                    [alt]="item.title || 'Video thumbnail'"
                    class="video-thumbnail-image"
                    loading="lazy">
                } @else {
                  <div class="video-thumbnail-placeholder">
                    <lucide-icon name="video" [size]="48"></lucide-icon>
                  </div>
                }

                <div class="video-play-overlay">
                  <div class="video-play-button">
                    <lucide-icon name="play" [size]="32"></lucide-icon>
                  </div>
                </div>

                @if (item.duration) {
                  <div class="video-duration">
                    {{ formatDuration(item.duration) }}
                  </div>
                }
              </div>
            }
          </div>

          <!-- Video info -->
          @if (item.title || item.description) {
            <div class="video-info">
              @if (item.title) {
                <h4 class="video-title">{{ item.title }}</h4>
              }
              @if (item.description) {
                <p class="video-description">{{ item.description }}</p>
              }
            </div>
          }
        </div>
      }
    </div>
  } @else {
    <div class="video-empty">
      <lucide-icon name="video-off" [size]="24"></lucide-icon>
      <span>No videos available</span>
    </div>
  }
</div>

