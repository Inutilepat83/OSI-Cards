<div class="ai-section ai-section--text-reference">
  <div class="ai-section__header">
    <div class="ai-section__details">
      <h3 class="ai-section__title">{{ section.title }}</h3>
      <p *ngIf="section.description" class="ai-section__description">{{ section.description }}</p>
    </div>
  </div>

  <div class="ai-section__body">
    <ng-container *ngIf="hasFields; else referenceEmpty">
      <div class="section-grid section-grid--reference">
        <article
        *ngFor="let field of fields"
        class="section-card section-card--reference"
        role="button"
        tabindex="0"
        [attr.aria-label]="'Open reference ' + (field.title || field.category || 'details')"
        (click)="onReferenceClick(field)"
        (keydown.enter)="onReferenceClick(field)"
        (keydown.space)="$event.preventDefault(); onReferenceClick(field)"
      >
        <div class="reference-card__content">
          <p class="reference-card__text">
            {{ getDisplayText(field) }}
          </p>
        </div>

        <footer class="reference-card__footer" *ngIf="field.referenceText || field.source || field.date || field.category">
          <div class="reference-card__meta">
            <span class="reference-card__category" *ngIf="field.category">{{ field.category }}</span>
            <span class="reference-card__source" *ngIf="field.source">{{ field.source }}</span>
            <span class="reference-card__reference" *ngIf="field.referenceText">{{ field.referenceText }}</span>
            <time class="reference-card__date" *ngIf="field.date">{{ field.date }}</time>
          </div>
          <a
            *ngIf="field.url"
            href="{{ field.url }}"
            target="_blank"
            rel="noopener noreferrer"
            class="reference-card__link"
            (click)="openReference(field, $event)"
          >
            <lucide-icon name="external-link" [size]="14" aria-hidden="true"></lucide-icon>
            <span>View source</span>
          </a>
        </footer>
      </article>
      </div>
    </ng-container>

    <ng-template #referenceEmpty>
      <div class="section-empty">
        <lucide-icon name="file-text" [size]="32" class="mb-4 opacity-50" aria-hidden="true"></lucide-icon>
        <p class="text-sm">No references available</p>
      </div>
    </ng-template>
  </div>
</div>

