@import 'sections-base';
@import 'unified-cards';
@import '../../core/color-helpers';

/**
 * Section Type System
 * ---------------------------------------------------------------------------
 * All sections share a common base structure defined here. Each type sets a
 * palette via CSS variables so that light and dark themes stay in sync while
 * preserving individual personalities.
 */

$section-base-shadow: 0 18px 40px $foreground-08;

.section-block {
  --section-accent: var(--color-brand, #{$brand-color});
  --section-bg: var(--section-surface, var(--section-background, var(--card-section-bg, #fafafa)));
  --section-border: #{$brand-color-30};
  --section-header-text: #{$foreground-80};
  --section-header-meta: #{$foreground-60};
  --section-card-background: var(--card-section-card-bg, #f5f5f5);
  --section-card-border: rgba(156, 163, 175, 0.5);
  --section-card-hover: var(--card-section-card-bg, #f5f5f5);
  --section-card-grid-min: 180px;
  --section-reflection-opacity: var(--section-reflection-opacity, 0);
  --section-reflection-offset-x: var(--section-reflection-offset-x, 0%);
  --section-reflection-offset-y: var(--section-reflection-offset-y, 0%);
  --section-reflection-angle: var(--section-reflection-angle, 0deg);

  position: relative !important;
  display: flex !important;
  flex-direction: column !important;
  gap: var(--section-card-gap) !important;
  padding: var(--section-padding) !important;
  border-radius: var(--card-border-radius) !important;
  border: var(--section-border) !important;
  background: var(--section-bg) !important;
  box-shadow: var(--card-box-shadow, 0 3px 12px rgba(0, 0, 0, 0.07)) !important;
  transition: border-color 350ms cubic-bezier(0.4, 0, 0.2, 1), 
              background 350ms cubic-bezier(0.4, 0, 0.2, 1), 
              box-shadow 350ms cubic-bezier(0.4, 0, 0.2, 1),
              transform 350ms cubic-bezier(0.4, 0, 0.2, 1) !important;
  overflow: hidden !important;
  box-sizing: border-box !important;
  
  animation: sectionFadeIn 0.5s cubic-bezier(0.4, 0, 0.2, 1) backwards !important;
  
  @keyframes sectionFadeIn {
    from {
      opacity: 0;
      transform: translateY(10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  &:hover {
    transform: translateY(-2px) !important;
    box-shadow: var(--card-box-shadow-hover, 0 8px 24px rgba(0, 0, 0, 0.12)), 0 0 0 1px $brand-color-15 !important;
    border-color: $brand-color-30 !important;
  }
}

.section-block__header {
  display: flex !important;
  align-items: center !important;
  justify-content: space-between !important;
  gap: calc(var(--card-gap) * 0.75) !important;
  flex-wrap: wrap !important;
  box-sizing: border-box !important;
}

.section-block__title {
  font-size: var(--section-title-font-size, 1.1rem) !important;
  font-weight: var(--section-title-font-weight, 700) !important;
  letter-spacing: var(--section-title-letter-spacing, -0.02em) !important;
  line-height: var(--section-title-line-height, 1.3) !important;
  color: var(--card-text-primary, $foreground-color) !important;
  padding: 0 !important;
  margin: 0 !important;
  transition: color 0.22s ease !important;
  font-family: inherit !important;
  border: none !important;
  
  .section-block:hover & {
    color: var(--card-text-primary, $foreground-color) !important;
  }
}

.section-block__subtitle {
  font-size: var(--font-section-description, 0.85rem) !important;
  color: var(--section-header-meta) !important;
  margin: 0 !important;
  font-family: inherit !important;
}

.section-block__badge {
  display: inline-flex !important;
  align-items: center !important;
  gap: calc(var(--card-gap) * 0.75) !important;
  padding: calc(var(--tag-padding-y-sm) * 0.75) calc(var(--tag-padding-x) * 0.875) !important;
  border-radius: 999px !important;
  border: none !important;
  background: $brand-color-12 !important;
  font-size: var(--font-section-meta, 0.7rem) !important;
  font-weight: 600 !important;
  text-transform: uppercase !important;
  letter-spacing: 0.08em !important;
  color: $brand-color-80 !important;
  font-family: inherit !important;
}

.section-grid {
  @include section-responsive-grid(var(--section-grid-min-width), var(--section-card-gap));
}

.section-list {
  display: flex !important;
  flex-direction: column !important;
  gap: var(--section-card-gap) !important;
}

.section-card {
  @include card;
}

.section-card--metric {
  min-height: auto !important;
  height: auto !important;
  display: flex !important;
  flex-direction: column !important;
  gap: var(--card-gap) !important;
  
  & > * {
    flex-shrink: 0 !important;
  }
}

.section-card__label {
  @extend %unified-card-label;
  display: flex !important;
  align-items: center !important;
  gap: calc(var(--card-gap) * 0.75) !important;
  text-transform: capitalize !important;

  > lucide-icon {
    color: $brand-color-70 !important;
    filter: none !important;
  }
}

.section-card__value {
  @extend %unified-card-value;
  font-size: calc(var(--card-value-font-size, 1rem) + 4px) !important;
  font-weight: var(--card-value-font-weight, 600) !important;
  letter-spacing: var(--card-value-letter-spacing, -0.015em) !important;
  line-height: var(--card-value-line-height, 1.35) !important;
  color: var(--card-text-primary, $foreground-color) !important;
  transition: color 0.25s ease !important;
  text-shadow: none !important;
  display: flex !important;
  align-items: center !important;
  gap: calc(var(--card-gap) * 0.75) !important;
  
  > lucide-icon {
    flex-shrink: 0 !important;
    opacity: 0.85 !important;
  }
}

.section-card__meta {
  display: flex !important;
  align-items: center !important;
  gap: calc(var(--card-gap) * 0.75) !important;
  font-size: var(--font-section-meta, 0.7rem) !important;
  color: $foreground-80 !important;
  line-height: 1.2 !important;
  font-family: inherit !important;
}

.section-card__progress {
  width: 100% !important;
  height: 6px !important;
  border-radius: var(--radius-xs) !important;
  background: $brand-color-12 !important;
  overflow: hidden !important;

  &-bar {
    height: 100% !important;
    border-radius: inherit !important;
    background: $brand-color-70 !important;
  }
}

.section-empty {
  padding: calc(var(--card-padding) * 1.5) !important;
  border-radius: var(--section-card-border-radius) !important;
  border: none !important;
  background: $brand-color-10 !important;
  text-align: center !important;
  color: $foreground-80 !important;
  min-height: auto !important;
}

/* -------------------------------------------------------------------------- */
/* Section Type Modifiers                                                     */
/* -------------------------------------------------------------------------- */

.section-block--metrics {
  --section-accent: var(--color-brand, #{$brand-color});
  --section-background: var(--card-section-bg, #fafafa);
  --section-card-background: var(--card-section-card-bg, #f5f5f5);
}

.section-block--insights {
  --section-accent: #{$brand-color-60};
  --section-background: rgba(250, 250, 250, 0.94);
  --section-card-background: var(--card-section-card-bg, #f5f5f5);
}

.section-block--list {
  --section-accent: #{$brand-color-50};
  --section-card-grid-min: 180px;
  --section-background: rgba(250, 250, 250, 0.93);
}

.section-block--contacts {
  --section-accent: #{$brand-color-70};
  --section-card-grid-min: 180px;
  --section-card-background: var(--card-section-card-bg, #f5f5f5);
}

.section-block--timeline {
  --section-accent: #{$brand-color-50};
  --section-card-grid-min: 200px;
}

.section-block--map {
  --section-accent: #{$brand-color-50};
  --section-card-grid-min: 220px;
  --section-background: rgba(250, 250, 250, 0.9);
}

.section-block--network {
  --section-accent: #{$brand-color-60};
  --section-card-grid-min: 200px;
}

.section-block--product {
  --section-accent: #{$brand-color-70};
  --section-background: rgba(250, 250, 250, 0.88);
  --section-card-background: var(--card-section-card-bg, #f5f5f5);
}

.section-block--financial {
  --section-accent: #{$brand-color-40};
  --section-card-background: var(--card-section-card-bg, #f5f5f5);
}

.section-block--solutions {
  --section-accent: #{$brand-color-60};
  --section-card-grid-min: 220px;
  --section-card-background: var(--card-section-card-bg, #f5f5f5);
}

@media (max-width: 768px) {
  .section-block {
    gap: var(--card-gap) !important;
    padding: clamp(12px, 2.5vw, 18px) !important;
  }

  .section-grid {
    grid-template-columns: repeat(auto-fit, minmax(var(--section-grid-min-width), 1fr)) !important;
    gap: var(--section-grid-gap-mobile) !important;
  }

  .section-list {
    gap: var(--section-grid-gap-mobile) !important;
  }
}

/* -------------------------------------------------------------------------- */
/* Theme Overrides                                                             */
/* -------------------------------------------------------------------------- */

/* Dark theme (Night Mode) */
:root[data-theme='night'],
:host-context([data-theme='night']) {
  .section-block {
    --section-header-text: rgba(255, 255, 255, 0.85);
    --section-header-meta: rgba(255, 255, 255, 0.6);
    --section-bg: var(--section-surface, rgba(30, 30, 35, 0.8));
    --section-card-background: rgba(40, 40, 48, 0.9);
    --section-card-border: rgba(100, 100, 120, 0.4);
  }

  .section-block__title {
    color: rgba(255, 255, 255, 0.95) !important;
  }

  .section-block__badge {
    background: rgba(255, 121, 0, 0.2) !important;
    color: rgba(255, 180, 100, 0.95) !important;
  }

  .section-card__value {
    color: rgba(255, 255, 255, 0.95) !important;
  }

  .section-card__meta {
    color: rgba(255, 255, 255, 0.7) !important;
  }

  .section-empty {
    background: rgba(255, 121, 0, 0.1) !important;
    color: rgba(255, 255, 255, 0.7) !important;
  }
}

/* Light theme (Day Mode) */
:root[data-theme='day'],
:host-context([data-theme='day']) {
  .section-block {
    --section-header-text: rgba(28, 28, 31, 0.85);
    --section-header-meta: rgba(28, 28, 31, 0.6);
    --section-bg: var(--section-surface, rgba(250, 250, 250, 0.95));
    --section-card-background: rgba(245, 245, 245, 0.95);
    --section-card-border: rgba(200, 200, 200, 0.5);
  }

  .section-block__title {
    color: #1a1a1a !important;
  }

  .section-card__value {
    color: #1a1a1a !important;
  }

  .section-card__meta {
    color: rgba(28, 28, 31, 0.7) !important;
  }

  .section-empty {
    color: rgba(28, 28, 31, 0.7) !important;
  }
}
