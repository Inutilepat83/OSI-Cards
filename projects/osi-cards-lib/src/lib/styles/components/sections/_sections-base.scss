// =====================================================================
// SECTIONS BASE - Clean, Consistent Card Styles
// =====================================================================
//
// Uses CSS variables from master tokens. No hardcoded shadows or effects.
//
// =====================================================================

@use "../../tokens/master" as *;

// =====================================================================
// GRID MIXINS
// =====================================================================

@mixin section-grid($min-width: var(--section-grid-min-width), $gap: var(--section-card-gap)) {
  display: grid;
  gap: $gap;
  grid-template-columns: repeat(auto-fit, minmax($min-width, 1fr));
  min-height: 0;
  box-sizing: border-box;

  @media (max-width: 420px) {
    grid-template-columns: 1fr;
  }
}

@mixin section-grid-responsive(
  $min-width: var(--section-grid-min-width),
  $gap: var(--section-card-gap),
  $tablet-breakpoint: 820px
) {
  display: grid;
  gap: $gap;
  grid-template-columns: repeat(auto-fit, minmax($min-width, 1fr));
  min-height: 0;
  box-sizing: border-box;

  @media (max-width: $tablet-breakpoint) {
    grid-template-columns: 1fr;
  }
}

// =====================================================================
// UNIVERSAL CARD MIXIN - Uses CSS Variables Only
// =====================================================================

@mixin card {
  background: var(--section-item-background, var(--osi-surface-raised));
  border: var(--section-item-border, 1px solid var(--osi-border));
  border-radius: var(--section-item-border-radius, var(--osi-radius-md));
  box-shadow: var(--section-item-box-shadow, var(--osi-shadow-sm));
  padding: var(--card-padding);

  display: flex;
  flex-direction: column;
  gap: var(--card-gap);
  min-height: var(--card-min-height, auto);

  cursor: pointer;
  position: relative;
  overflow: hidden;
  box-sizing: border-box;
  text-align: left;

  transition:
    background 0.2s ease,
    box-shadow 0.2s ease,
    border-color 0.2s ease,
    transform 0.2s ease;

  // Subtle accent border indicator
  &::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 2px;
    background: linear-gradient(90deg, var(--accent, var(--osi-accent)) 0%, transparent 100%);
    opacity: 0;
    transition: opacity 0.2s ease;
    border-radius: var(--section-item-border-radius, var(--osi-radius-md))
      var(--section-item-border-radius, var(--osi-radius-md)) 0 0;
  }

  &:hover {
    background: var(--section-item-background-hover, var(--osi-surface-hover));
    border-color: var(--section-item-border-hover, var(--osi-border));
    box-shadow: var(--section-item-box-shadow-hover, var(--osi-shadow-md));
    transform: translateY(-2px);

    &::before {
      opacity: 0.6;
    }
  }

  &:focus-visible {
    outline: 2px solid var(--accent, var(--osi-accent));
    outline-offset: 2px;
  }

  @media (prefers-reduced-motion: reduce) {
    transition: none;

    &:hover {
      transform: none;
    }
  }
}

// =====================================================================
// UNIFIED SECTION CARD CLASS
// =====================================================================

.unified-card {
  @include card;
}

.section-card {
  @include card;
}

// =====================================================================
// TYPOGRAPHY MIXINS - Use CSS Variables
// =====================================================================

@mixin metric-label {
  font-size: var(--card-label-font-size);
  font-weight: 600;
  letter-spacing: 0.04em;
  text-transform: uppercase;
  color: var(--muted-foreground);
  line-height: 1.3;
  font-family: inherit;
}

@mixin metric-value {
  font-size: var(--card-value-font-size);
  font-weight: 600;
  color: var(--foreground);
  letter-spacing: -0.01em;
  line-height: 1.3;
  font-family: inherit;
}

@mixin section-description {
  font-size: var(--card-subtitle-font-size);
  color: var(--muted-foreground);
  line-height: 1.5;
  font-weight: 400;
  font-family: inherit;
}

// Legacy aliases
@mixin section-label {
  @include metric-label;
}

@mixin section-value {
  @include metric-value;
}

// =====================================================================
// EMPTY STATE
// =====================================================================

@mixin section-empty-state {
  padding: calc(var(--card-padding) * 1.5);
  text-align: center;
  color: var(--muted-foreground);
  border: 1px dashed var(--border);
  border-radius: var(--section-item-border-radius);
  background: var(--section-item-background);
  min-height: auto;
}

@mixin section-empty-icon {
  margin: 0 auto var(--card-gap);
  opacity: 0.5;
}

// =====================================================================
// TREND COLORS
// =====================================================================

@mixin trend-colors {
  &.trend--up {
    color: #{$osi-color-trend-up};
  }

  &.trend--down {
    color: #{$osi-color-trend-down};
  }

  &.trend--stable {
    color: #{$osi-color-trend-stable};
  }

  &.trend--neutral {
    color: #{$osi-color-trend-neutral};
  }
}

// =====================================================================
// STATUS CLASSES
// =====================================================================

.status--completed,
.status--success {
  color: #{$success-color};
  background: #{$success-color-10};
}

.status--active,
.status--in-progress {
  color: var(--accent);
  background: #{$brand-color-10};
}

.status--pending,
.status--warning {
  color: #{$warning-color};
  background: #{$warning-color-10};
}

.status--blocked,
.status--cancelled,
.status--delayed,
.status--inactive,
.status--error {
  color: #{$error-color};
  background: #{$error-color-10};
}

.status--default {
  color: var(--muted-foreground);
  background: var(--muted);
}

// =====================================================================
// PRIORITY CLASSES
// =====================================================================

.priority--high {
  color: #{$error-color};
  background: #{$error-color-10};
}

.priority--medium {
  color: #{$warning-color};
  background: #{$warning-color-10};
}

.priority--low {
  color: #{$success-color};
  background: #{$success-color-10};
}

.priority--default {
  color: var(--muted-foreground);
  background: var(--muted);
}

// =====================================================================
// REDUCED MOTION
// =====================================================================

@media (prefers-reduced-motion: reduce) {
  .unified-card,
  .section-card,
  [class*="__card"],
  [class*="-card"],
  [class*="__item"],
  [class*="-item"] {
    transition: none;
    animation: none;
  }
}

// =====================================================================
// ANIMATION SYSTEM
// =====================================================================

@keyframes section-item-stream {
  0% {
    opacity: 0;
    transform: translateY(3px);
  }
  100% {
    opacity: 1;
    transform: translateY(0);
  }
}

@mixin section-item-animation {
  &.section-item-streaming {
    animation: section-item-stream 0.25s ease-out forwards;
  }

  &.section-item-entered {
    animation: none;
  }

  @for $i from 0 through 15 {
    &.section-item-stagger-#{$i} {
      animation-delay: calc(#{$i} * 30ms);
    }
  }
}

@mixin legacy-item-animation {
  &.item-streaming {
    animation: section-item-stream 0.25s ease-out forwards;
  }

  &.item-entered {
    animation: none;
  }

  @for $i from 0 through 15 {
    &.item-stagger-#{$i} {
      animation-delay: calc(#{$i} * 30ms);
    }
  }
}

@mixin legacy-field-animation {
  &.field-streaming {
    animation: section-item-stream 0.25s ease-out forwards;
  }

  &.field-entered {
    animation: none;
  }

  @for $i from 0 through 15 {
    &.field-stagger-#{$i} {
      animation-delay: calc(#{$i} * 30ms);
    }
  }
}
