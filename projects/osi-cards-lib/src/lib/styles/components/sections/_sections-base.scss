// =====================================================================
// SECTIONS BASE - Consolidated base styles for all card sections
// =====================================================================
//
// Imports from master tokens for consistency.
//
// =====================================================================

@use '../../tokens/master' as *;

// =====================================================================
// GRID MIXINS
// =====================================================================

@mixin section-grid($min-width: var(--section-grid-min-width), $gap: var(--section-card-gap)) {
  display: grid !important;
  gap: $gap !important;
  grid-template-columns: repeat(auto-fit, minmax($min-width, 1fr)) !important;
  min-height: 0 !important;
  box-sizing: border-box !important;

  @media (max-width: 420px) {
    grid-template-columns: 1fr !important;
  }
}

@mixin section-grid-responsive($min-width: var(--section-grid-min-width), $gap: var(--section-card-gap), $tablet-breakpoint: 820px) {
  display: grid !important;
  gap: $gap !important;
  grid-template-columns: repeat(auto-fit, minmax($min-width, 1fr)) !important;
  min-height: 0 !important;
  box-sizing: border-box !important;

  @media (max-width: $tablet-breakpoint) {
    grid-template-columns: 1fr !important;
  }
}

// =====================================================================
// UNIVERSAL CARD MIXIN
// =====================================================================

@mixin card {
  // Use section-item variables for consistency
  border: var(--section-item-border, 1px solid rgba(0, 0, 0, 0.14)) !important;
  border-radius: var(--section-item-border-radius) !important;
  padding: var(--card-padding) !important;
  background: linear-gradient(135deg, var(--section-item-background, #fafafa) 0%, rgba(250, 250, 250, 0.98) 100%) !important;
  display: flex !important;
  flex-direction: column !important;
  gap: var(--card-gap) !important;
  min-height: var(--card-min-height, auto) !important;
  cursor: pointer !important;
  position: relative !important;
  overflow: hidden !important;
  box-shadow: var(--section-item-box-shadow, 0 1px 2px rgba(0, 0, 0, 0.05)) !important;
  box-sizing: border-box !important;
  text-align: left !important;

  transition: background 0.22s ease,
    box-shadow 0.22s ease,
    border-color 0.22s ease,
    transform 0.22s ease !important;

  // Minimalistic accent line on left
  &::before {
    content: '' !important;
    position: absolute !important;
    left: 0 !important;
    top: 0 !important;
    bottom: 0 !important;
    width: 3px !important;
    background: #{$brand-color-60} !important;
    opacity: 0 !important;
    transition: opacity 0.22s ease !important;
    border-radius: 0 2px 2px 0 !important;
  }

  &:hover {
    box-shadow: var(--section-item-box-shadow-hover, 0 1px 3px rgba(0, 0, 0, 0.08)),
      0 0 0 1px #{$brand-color-15} !important;
    transform: translateY(-2px) var(--section-item-hover-transform, scale(1)) !important;
    border-color: #{$brand-color-20} !important;

    &::before {
      opacity: 0.6 !important;
    }
  }

  &:focus-visible {
    outline: 2px solid #{$brand-color-60} !important;
    outline-offset: 2px !important;
    border-color: #{$brand-color-50} !important;
  }

  &:not(:hover) {
    will-change: auto !important;
  }

  @media (prefers-reduced-motion: reduce) {
    transition: none !important;
    will-change: auto !important;
    transform: none !important;

    &::before {
      display: none;
    }
  }
}

// =====================================================================
// UNIFIED SECTION CARD CLASS
// =====================================================================

.unified-card {
  @include card;
}

.section-card {
  @include card;
}

// =====================================================================
// METRIC TYPOGRAPHY MIXINS
// =====================================================================

@mixin metric-label {
  font-size: var(--card-label-font-size, 0.5rem) !important;
  letter-spacing: 0.04em !important;
  text-transform: none !important;
  color: var(--card-text-label, #{$text-secondary}) !important;
  line-height: 1.3 !important;
  font-weight: 600 !important;
  text-align: left !important;
  transition: color 0.22s ease !important;
  font-family: inherit !important;

  .section-card:hover &,
  .unified-card:hover & {
    color: var(--card-text-label, #{$text-secondary}) !important;
  }
}

@mixin metric-value {
  font-size: var(--card-value-font-size, 1rem) !important;
  font-weight: 700 !important;
  color: var(--foreground, #{$foreground-color}) !important;
  letter-spacing: -0.01em !important;
  line-height: 1.2 !important;
  text-align: left !important;
  transition: color 0.22s ease !important;
  font-family: inherit !important;

  .section-card:hover &,
  .unified-card:hover & {
    color: var(--foreground, #{$foreground-color}) !important;
  }
}

@mixin section-description {
  font-size: var(--font-section-description, 0.85rem) !important;
  color: #{$foreground-70} !important;
  letter-spacing: 0.01em !important;
  line-height: 1.4 !important;
  font-weight: 400 !important;
  text-align: left !important;
  font-family: inherit !important;
}

// Legacy aliases
@mixin section-label {
  @include metric-label;
}

@mixin section-value {
  @include metric-value;
}

// =====================================================================
// COMMON COMPONENTS
// =====================================================================

@mixin section-empty-state($accent: var(--section-accent, var(--accent, #{$brand-color}))) {
  padding: calc(var(--card-padding) * 1.5) !important;
  text-align: center !important;
  color: #{$foreground-50} !important;
  border: none !important;
  border-radius: var(--section-card-border-radius) !important;
  background: #{$brand-color-10} !important;
  min-height: auto !important;
}

@mixin section-empty-icon {
  margin: 0 auto var(--card-gap) !important;
  opacity: 0.65 !important;
  filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.22)) !important;
}

// =====================================================================
// TREND COLORS
// =====================================================================

@mixin trend-colors {
  &.trend--up {
    color: #{$osi-color-trend-up} !important;
  }

  &.trend--down {
    color: #{$osi-color-trend-down} !important;
  }

  &.trend--stable {
    color: #{$osi-color-trend-stable} !important;
  }

  &.trend--neutral {
    color: #{$osi-color-trend-neutral} !important;
  }
}

// =====================================================================
// STANDARDIZED STATUS CLASSES
// =====================================================================

.status--completed,
.status--success {
  border-color: rgba(74, 222, 128, 0.4) !important;
  color: rgba(134, 239, 172, 1) !important;
  background: #{$success-color-15} !important;
}

.status--active,
.status--in-progress {
  border-color: #{$brand-color-40} !important;
  color: #{$brand-color-70} !important;
  background: #{$brand-color-15} !important;
}

.status--pending,
.status--warning {
  border-color: rgba(251, 191, 36, 0.4) !important;
  color: rgba(253, 224, 71, 1) !important;
  background: #{$warning-color-15} !important;
}

.status--blocked,
.status--cancelled,
.status--delayed,
.status--inactive,
.status--error {
  border-color: rgba(248, 113, 113, 0.4) !important;
  color: rgba(252, 165, 165, 1) !important;
  background: #{$error-color-15} !important;
}

.status--default {
  border-color: rgba(120, 120, 120, 0.4) !important;
  color: rgba(200, 200, 200, 0.85) !important;
  background: rgba(40, 40, 40, 0.2) !important;
}

// =====================================================================
// STANDARDIZED PRIORITY CLASSES
// =====================================================================

.priority--high {
  border-color: rgba(248, 113, 113, 0.4) !important;
  color: rgba(252, 165, 165, 1) !important;
  background: #{$error-color-15} !important;
}

.priority--medium {
  border-color: rgba(251, 191, 36, 0.4) !important;
  color: rgba(253, 224, 71, 1) !important;
  background: #{$warning-color-15} !important;
}

.priority--low {
  border-color: rgba(74, 222, 128, 0.4) !important;
  color: rgba(134, 239, 172, 1) !important;
  background: #{$success-color-15} !important;
}

.priority--default {
  border-color: rgba(120, 120, 120, 0.4) !important;
  color: rgba(200, 200, 200, 0.85) !important;
  background: rgba(40, 40, 40, 0.2) !important;
}

// =====================================================================
// REDUCED MOTION SUPPORT
// =====================================================================

@media (prefers-reduced-motion: reduce) {
  .unified-card,
  .section-card,
  [class*='__card'],
  [class*='-card'],
  [class*='__item'],
  [class*='-item'] {
    transition: none !important;
    animation: none !important;
  }

  .trend--up,
  .trend--down,
  .trend--stable,
  .trend--neutral {
    text-shadow: none !important;
    filter: none !important;
  }

  .status--completed,
  .status--success,
  .status--active,
  .status--in-progress,
  .status--pending,
  .status--warning,
  .status--blocked,
  .status--cancelled,
  .status--delayed,
  .status--inactive,
  .status--error,
  .status--default,
  .priority--high,
  .priority--medium,
  .priority--low,
  .priority--default {
    filter: none !important;
  }
}

// =====================================================================
// THEME OVERRIDES
// =====================================================================

// Dark theme (Night Mode)
:root[data-theme='night'],
:host-context([data-theme='night']) {
  .unified-card,
  .section-card {
    --section-item-background: rgba(40, 40, 48, 0.9);
    --section-item-border: 1px solid rgba(100, 100, 120, 0.4);
    --section-item-box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    --section-item-box-shadow-hover: 0 4px 8px rgba(0, 0, 0, 0.3);
    background: linear-gradient(135deg, rgba(40, 40, 48, 0.9) 0%, rgba(35, 35, 42, 0.95) 100%) !important;
    border-color: rgba(100, 100, 120, 0.4) !important;
  }
}

// Light theme (Day Mode)  
:root[data-theme='day'],
:host-context([data-theme='day']) {
  .unified-card,
  .section-card {
    --section-item-background: rgba(250, 250, 250, 0.95);
    --section-item-border: 1px solid rgba(200, 200, 200, 0.5);
    --section-item-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
    --section-item-box-shadow-hover: 0 2px 4px rgba(0, 0, 0, 0.08);
    background: linear-gradient(135deg, rgba(250, 250, 250, 0.95) 0%, rgba(255, 255, 255, 0.98) 100%) !important;
    border-color: rgba(200, 200, 200, 0.5) !important;
  }
}
