/* Analytics metric cards with progress and trend indicators */
/* OPTIMIZED: Compact design with clear visual hierarchy */

@import 'design-system';
@import '../../core/color-helpers';


.analytics-metrics {
  display: grid !important;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)) !important;
  gap: var(--section-card-gap) !important;
  width: 100% !important;
  box-sizing: border-box !important;
  
  @media (max-width: 820px) {
    grid-template-columns: 1fr !important;
  }
}

.analytics-metric {
  // All declarations must come BEFORE @include card (which contains nested rules)
  min-height: auto !important;
  justify-content: space-between !important;
  display: flex !important;
  flex-direction: column !important;
  gap: calc(var(--card-gap) * 0.75) !important;
  padding: var(--card-padding) !important;
  transition: all 0.22s cubic-bezier(0.4, 0, 0.2, 1) !important;
  position: relative !important;
  overflow: hidden !important;
  box-sizing: border-box !important;
  text-align: left !important;
  background: var(--card-background, #fafafa) !important;

  // Include mixin after all declarations
  @include card;

  &::before {
    content: '' !important;
    position: absolute !important;
    top: 0 !important;
    left: 0 !important;
    right: 0 !important;
    height: 3px !important;
    background: var(--color-brand, $brand-color) !important;
    opacity: 0 !important;
    transition: opacity 0.22s ease !important;
    pointer-events: none !important;
  }
  
  &::after {
    content: '' !important;
    position: absolute !important;
    inset: 0 !important;
    background: radial-gradient(circle at center, $brand-color-03, transparent) !important;
    opacity: 0 !important;
    transition: opacity 0.22s ease !important;
    pointer-events: none !important;
  }

  &:hover {
    transform: translateY(-2px) !important;
    box-shadow: 0 8px 16px $foreground-12, 0 0 0 1px $brand-color-15 !important;

    &::before {
      opacity: 1 !important;
    }
    
    &::after {
      opacity: 1 !important;
    }

    .analytics-metric__value {
      color: var(--foreground, $foreground-color) !important;
    }
    
    .analytics-metric__label {
      color: var(--card-text-secondary, $text-secondary) !important;
    }
  }

  &:focus-visible {
    outline: 2px solid var(--color-brand, $brand-color) !important;
    outline-offset: 2px !important;
  }

  &__header {
    display: flex !important;
    align-items: center !important;
    justify-content: space-between !important;
    gap: var(--card-gap) !important;
    margin-bottom: calc(var(--card-gap) * 0.25) !important;
    box-sizing: border-box !important;
  }

  &__label {
    display: flex !important;
    align-items: center !important;
    gap: calc(var(--card-gap) * 0.5) !important;
    margin: 0 !important;
    flex-shrink: 0 !important;
    color: var(--card-text-label, $text-secondary) !important;
    font-weight: 600 !important;
    letter-spacing: 0.04em !important;
    font-size: var(--card-label-font-size, 0.5rem) !important;
    line-height: 1.3 !important;
    transition: color 0.22s ease !important;
    font-family: inherit !important;

    @include label-text;

    lucide-icon {
      flex-shrink: 0 !important;
      transition: color 0.22s ease !important;
      @include icon-base(14px);
    }
  }

  &__value {
    margin: 0 !important;
    color: var(--color-brand, $brand-color) !important;
    font-weight: 700 !important;
    font-size: calc(var(--card-value-font-size-large, 1.2rem) * 1.3) !important;
    letter-spacing: -0.01em !important;
    line-height: 1.2 !important;
    transition: color 0.22s ease !important;
    text-align: left !important;
    flex-shrink: 0 !important;
    font-family: inherit !important;
    border: none !important;
    padding: 0 !important;

    @include value-text-lg;
  }

  &:hover .analytics-metric__label lucide-icon {
    opacity: 1 !important;
  }

  &__progress {
    margin: calc(var(--card-gap) * 0.75) 0 calc(var(--card-gap) * 0.5) 0 !important;
    height: 6px !important;
    border-radius: 2px !important;
    background: linear-gradient(90deg, transparent, $brand-color-10, transparent) !important;
    box-shadow: 0 0 8px $brand-color-20 !important;
    overflow: hidden !important;

    @include progress-bar;

    .section-card__progress-bar {
      height: 100% !important;
      background: linear-gradient(90deg, var(--color-brand, $brand-color), $brand-color-60) !important;
      border-radius: inherit !important;
      transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1) !important;
    }
  }

  &__meta {
    display: flex !important;
    justify-content: flex-start !important;
    align-items: center !important;
    flex-wrap: wrap !important;
    gap: calc(var(--card-gap) * 0.5) !important;
    width: 100% !important;
    font-size: var(--card-meta-font-size, 0.6rem) !important;
    color: var(--card-text-muted, $text-secondary) !important;
    font-weight: 500 !important;
    line-height: 1.4 !important;
    padding: calc(var(--card-gap) * 0.3) 0 !important;
    transition: color 0.25s ease !important;
    font-family: inherit !important;

    lucide-icon {
      flex-shrink: 0 !important;
      opacity: 0.8 !important;
      color: var(--color-brand, $brand-color) !important;
      transition: opacity 0.25s ease, color 0.25s ease !important;
      @include icon-base(16px);
      @include trend-colors;
    }
  }
  
  &:hover .analytics-metric__meta {
    color: var(--card-text-secondary, $text-secondary) !important;
    
    lucide-icon {
      opacity: 1 !important;
    }
  }

  &__meta-change {
    font-weight: 600 !important;
    font-size: var(--card-meta-font-size, 0.6rem) !important;
    font-family: inherit !important;
    @include trend-colors;
  }
}

.analytics-progress {
  @include progress-bar;

  &::after {
    width: var(--progress-width, 0%) !important;
    background: linear-gradient(90deg, $brand-color-60, $brand-color-80) !important;
  }
}

/* Empty state */
.analytics-empty {
  @include empty-state;
}

/* Fullscreen mode - ultra compact */
.ai-card-surface--fullscreen {
  .analytics-metrics {
    gap: var(--card-gap) !important;
  }
  
  .analytics-metric {
    padding: var(--card-padding) !important;
    
    &__label {
      gap: var(--card-gap) !important;
      margin-bottom: 4px !important;
      
      lucide-icon {
        width: 12px !important;
        height: 12px !important;
      }
    }
    
    &__progress {
      margin-top: 6px !important;
      height: 5px !important;
    }
    
    &__meta {
      gap: var(--card-gap) !important;
      margin-top: 6px !important;
      
      lucide-icon {
        width: 11px !important;
        height: 11px !important;
      }
    }
  }
}

/* Light theme overrides */
:root[data-theme='day'] {
  .analytics-metric {
    &__label {
      color: #6b7280 !important;
    }
    
    &:hover &__label {
      color: #4b5563 !important;
    }
    
    &__value {
      color: #1a1a1a !important;
    }
    
    &:hover &__value {
      color: var(--primary, $brand-color) !important;
      text-shadow: none !important;
    }
    
    &__meta {
      color: #6b7280 !important;
    }
  }
  
  .analytics-progress {
    background: rgba(200, 200, 200, 0.2) !important;
    
    &::after {
      background: linear-gradient(90deg, $brand-color-80, $brand-color) !important;
    }
  }
}
