{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "OSI Cards Section Registry",
  "description": "Schema for the section registry - single source of truth for all section types",
  "type": "object",
  "required": ["version", "sections"],
  "properties": {
    "$schema": {
      "type": "string",
      "description": "JSON Schema reference"
    },
    "version": {
      "type": "string",
      "pattern": "^\\d+\\.\\d+\\.\\d+$",
      "description": "Registry schema version (semver)"
    },
    "description": {
      "type": "string",
      "description": "Registry description"
    },
    "sections": {
      "type": "object",
      "description": "Map of section type ID to section definition",
      "additionalProperties": {
        "$ref": "#/definitions/SectionDefinition"
      }
    },
    "typeAliases": {
      "type": "object",
      "description": "Map of type aliases to canonical type names",
      "additionalProperties": {
        "type": "string"
      }
    },
    "defaultSection": {
      "type": "string",
      "description": "Default section type for unknown types"
    },
    "allSectionsExample": {
      "type": "object",
      "description": "Complete card example demonstrating all section types",
      "properties": {
        "cardTitle": { "type": "string" },
        "cardType": { "type": "string" },
        "description": { "type": "string" },
        "sections": {
          "type": "array",
          "items": { "type": "object" }
        },
        "actions": {
          "type": "array",
          "items": { "type": "object" }
        }
      }
    }
  },
  "definitions": {
    "SectionDefinition": {
      "type": "object",
      "required": [
        "name",
        "description",
        "componentPath",
        "selector",
        "rendering"
      ],
      "properties": {
        "name": {
          "type": "string",
          "description": "Human-readable section name"
        },
        "description": {
          "type": "string",
          "description": "Detailed description of the section"
        },
        "componentPath": {
          "type": "string",
          "description": "Path to the component file (relative to src/)"
        },
        "stylePath": {
          "type": "string",
          "description": "Path to the SCSS file (relative to src/)"
        },
        "selector": {
          "type": "string",
          "pattern": "^app-[a-z-]+$",
          "description": "Angular component selector"
        },
        "useCases": {
          "type": "array",
          "items": { "type": "string" },
          "description": "List of use cases for this section"
        },
        "bestPractices": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Best practices for using this section"
        },
        "rendering": {
          "$ref": "#/definitions/RenderingConfig"
        },
        "fieldSchema": {
          "$ref": "#/definitions/JSONSchema",
          "description": "JSON Schema for field objects"
        },
        "itemSchema": {
          "$ref": "#/definitions/JSONSchema",
          "description": "JSON Schema for item objects"
        },
        "chartSchema": {
          "$ref": "#/definitions/JSONSchema",
          "description": "JSON Schema for chart configuration"
        },
        "aliases": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Alternative type names that resolve to this section"
        },
        "isInternal": {
          "type": "boolean",
          "description": "Whether this is an internal section (not for external use)"
        },
        "examples": {
          "$ref": "#/definitions/Examples"
        },
        "documentation": {
          "$ref": "#/definitions/Documentation"
        },
        "demo": {
          "$ref": "#/definitions/DemoConfig"
        },
        "examplePath": {
          "type": "string",
          "description": "Path to standalone example JSON file (relative to section folder)"
        },
        "completionRules": {
          "$ref": "#/definitions/CompletionRules",
          "description": "Rules for determining if a section is complete and should be displayed"
        }
      }
    },
    "CompletionRules": {
      "type": "object",
      "description": "Rules for validating section completeness",
      "properties": {
        "minFields": {
          "type": "integer",
          "minimum": 0,
          "description": "Minimum number of fields required (for field-based sections)"
        },
        "minItems": {
          "type": "integer",
          "minimum": 0,
          "description": "Minimum number of items required (for item-based sections)"
        },
        "requireNonEmptyValues": {
          "type": "boolean",
          "description": "Whether fields/items must have non-empty values"
        },
        "mandatoryFields": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Array of field property names that must be present (e.g., ['label', 'value'])"
        },
        "requireChartData": {
          "type": "boolean",
          "description": "Whether chartData is required (for chart sections)"
        }
      }
    },
    "RenderingConfig": {
      "type": "object",
      "required": ["usesFields", "usesItems", "defaultColumns"],
      "properties": {
        "usesFields": {
          "type": "boolean",
          "description": "Whether section uses fields array"
        },
        "usesItems": {
          "type": "boolean",
          "description": "Whether section uses items array"
        },
        "usesChartData": {
          "type": "boolean",
          "description": "Whether section uses chartData"
        },
        "defaultColumns": {
          "type": "integer",
          "minimum": 1,
          "maximum": 4,
          "description": "Default column span"
        },
        "supportsCollapse": {
          "type": "boolean",
          "description": "Whether section supports collapse/expand"
        },
        "requiresExternalLib": {
          "type": "string",
          "description": "External library requirement (e.g., 'leaflet', 'chart.js')"
        },
        "supportsEmoji": {
          "type": "boolean",
          "description": "Whether section supports emoji in titles and content"
        }
      }
    },
    "Examples": {
      "type": "object",
      "description": "JSON examples for documentation and testing",
      "properties": {
        "demo": {
          "type": "object",
          "description": "Demo example for showcases - comprehensive example showing typical use case with multiple entries. Used in demo cards and showcases."
        },
        "doc": {
          "type": "object",
          "description": "Documentation example - minimal example with single entry. Used in documentation and prompt generation. Should be concise and show basic structure."
        },
        "long": {
          "type": "object",
          "description": "Long/comprehensive example - extensive example showing all features, edge cases, and multiple data points. Used for reference and comprehensive demonstrations. Recommended for showing how sections handle multiple entries."
        },
        "example": {
          "type": "object",
          "description": "Legacy: Representative example (backward compatibility - prefer using demo/doc/long)"
        },
        "complete": {
          "type": "object",
          "description": "Legacy: Complete example (deprecated, use 'demo' or 'long' instead)"
        },
        "minimal": {
          "type": "object",
          "description": "Legacy: Minimal example (deprecated, use 'doc' instead)"
        },
        "edgeCases": {
          "type": "object",
          "description": "Legacy: Edge case example (deprecated, use 'long' instead)"
        }
      }
    },
    "Documentation": {
      "type": "object",
      "description": "Documentation examples and code snippets",
      "properties": {
        "examples": {
          "type": "array",
          "description": "Array of documentation examples",
          "items": {
            "type": "object",
            "properties": {
              "name": { "type": "string", "description": "Example name" },
              "description": {
                "type": "string",
                "description": "Example description"
              },
              "section": {
                "type": "object",
                "description": "Section configuration"
              }
            },
            "required": ["name", "section"]
          }
        },
        "codeSnippets": {
          "type": "object",
          "description": "Code snippets for documentation",
          "properties": {
            "typescript": {
              "type": "string",
              "description": "TypeScript usage example"
            },
            "html": {
              "type": "string",
              "description": "HTML template example"
            },
            "json": {
              "type": "string",
              "description": "JSON configuration example"
            }
          }
        },
        "apiNotes": {
          "type": "string",
          "description": "Additional API documentation notes"
        }
      }
    },
    "DemoConfig": {
      "type": "object",
      "description": "Configuration for demo application",
      "properties": {
        "sampleCards": {
          "type": "array",
          "description": "Sample cards featuring this section type",
          "items": {
            "type": "object",
            "properties": {
              "name": { "type": "string", "description": "Sample card name" },
              "description": {
                "type": "string",
                "description": "Card description"
              },
              "card": {
                "type": "object",
                "description": "Full card configuration"
              }
            },
            "required": ["name", "card"]
          }
        },
        "featured": {
          "type": "boolean",
          "description": "Whether to feature this section in demo homepage"
        },
        "order": {
          "type": "integer",
          "description": "Display order in demo app"
        }
      }
    },
    "JSONSchema": {
      "type": "object",
      "description": "JSON Schema definition for data validation"
    }
  }
}
